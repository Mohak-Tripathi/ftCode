(this["webpackJsonppixel-sense"]=this["webpackJsonppixel-sense"]||[]).push([[0],{248:function(e,t){},281:function(e,t,a){},282:function(e,t,a){},283:function(e,t,a){},332:function(e,t,a){},333:function(e,t,a){},336:function(e,t,a){},337:function(e,t,a){},338:function(e,t,a){},339:function(e,t,a){},340:function(e,t,a){},341:function(e,t,a){},342:function(e,t,a){},343:function(e,t,a){},344:function(e,t,a){},345:function(e,t,a){},346:function(e,t,a){},347:function(e,t,a){},348:function(e,t,a){},349:function(e,t,a){},354:function(e,t){},355:function(e,t){},363:function(e,t){},365:function(e,t,a){},366:function(e,t,a){},367:function(e,t,a){},368:function(e,t,a){},369:function(e,t,a){},370:function(e,t,a){},371:function(e,t,a){},372:function(e,t,a){},391:function(e,t,a){},392:function(e,t,a){},393:function(e,t,a){},394:function(e,t,a){},396:function(e,t){},397:function(e,t){},398:function(e,t,a){},410:function(e,t,a){},411:function(e,t,a){},412:function(e,t,a){},413:function(e,t,a){},414:function(e,t,a){},415:function(e,t,a){},416:function(e,t,a){},417:function(e,t,a){},418:function(e,t,a){},419:function(e,t,a){},420:function(e,t,a){},421:function(e,t,a){},422:function(e,t,a){},435:function(e,t,a){},436:function(e,t,a){},437:function(e,t,a){},438:function(e,t,a){"use strict";a.r(t),a.d(t,"store",(function(){return Ii}));var i=a(7),s=a.n(i),n=a(106),o=a.n(n),r=(a(281),a(282),a(283),a(16));let l=function(e){return e.TOP="TOP",e.BOTTOM="BOTTOM",e.LEFT="LEFT",e.RIGHT="RIGHT",e.TOP_RIGHT="TOP_RIGHT",e.TOP_LEFT="TOP_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.CENTER="CENTER",e}({}),c=function(e){return e.LOAD_CAMERA_ID="LOAD_CAMERA_ID",e.SELECT_CAMERA_ID="SELECT_CAMERA_ID",e.LOAD_LABEL_NAMES="LOAD_LABEL_NAMES",e.UPDATE_LABEL="UPDATE_LABEL",e.SUGGEST_LABEL_NAMES="SUGGEST_LABEL_NAMES",e.IMPORT_IMAGES="IMPORT_IMAGES",e.LOAD_AI_MODEL="LOAD_AI_MODEL",e.EXPORT_ANNOTATIONS="EXPORT_ANNOTATIONS",e.IMPORT_ANNOTATIONS="IMPORT_ANNOTATIONS",e.UPLOAD_ANNOTATIONS="UPLOAD_ANNOTATIONS",e.DOWNLOAD_ANNOTATIONS="DOWNLOAD_ANNOTATIONS",e.DELETE_ANNOTATIONS="DELETE_ANNOTATIONS",e.INSERT_LABEL_NAMES="INSERT_LABEL_NAMES",e.EXIT_PROJECT="EXIT_PROJECT",e.LOADER="LOADER",e.ERROR="ERROR",e}({});var d;class g{}d=g,g.GITHUB_URL="https://github.com/SkalskiP",g.MEDIUM_URL="https://medium.com/@piotr.skalski92",g.PATREON_URL="https://www.patreon.com/make_sense",g.TOP_NAVIGATION_BAR_HEIGHT_PX=35,g.EDITOR_BOTTOM_NAVIGATION_BAR_HEIGHT_PX=41,g.EDITOR_TOP_NAVIGATION_BAR_HEIGHT_PX=41,g.SIDE_NAVIGATION_BAR_WIDTH_CLOSED_PX=24,g.SIDE_NAVIGATION_BAR_WIDTH_OPEN_PX=d.SIDE_NAVIGATION_BAR_WIDTH_CLOSED_PX+300+1,g.TOOLKIT_TAB_HEIGHT_PX=40,g.TOOLBOX_PANEL_WIDTH_PX=51,g.EDITOR_MIN_WIDTH=900,g.EDITOR_MIN_HEIGHT=500,g.PRIMARY_COLOR="#2af598",g.SECONDARY_COLOR="#009efd",g.DARK_THEME_FIRST_COLOR="#171717",g.DARK_THEME_SECOND_COLOR="#282828",g.DARK_THEME_THIRD_COLOR="#4c4c4c",g.DARK_THEME_FORTH_COLOR="#262c2f",g.CROSS_HAIR_THICKNESS_PX=1,g.CROSS_HAIR_COLOR="#fff",g.RESIZE_HANDLE_DIMENSION_PX=8,g.RESIZE_HANDLE_HOVER_DIMENSION_PX=16,g.CLOSEABLE_POPUPS=[c.IMPORT_IMAGES,c.EXPORT_ANNOTATIONS,c.IMPORT_ANNOTATIONS,c.EXIT_PROJECT,c.UPDATE_LABEL];let h=function(e){return e.IMAGE_RECOGNITION="IMAGE RECOGNITION",e.POINT="POINT",e.RECT="RECT",e.POLYGON="POLYGON",e.LINE="LINE",e}({});var u=a(41),p=a.n(u);class b{static calculateGridSize(e,t,a){const i=Math.floor(e.width/t.width);return{width:i,height:Math.ceil(a/i)}}static calculateContentSize(e,t,a){const i={width:t.width*a.width,height:t.height*a.height};return{width:Math.max(e.width,i.width),height:i.height}}static calculateAnchorPoints(e,t,a){const i=b.calculateGridSize(e,t,a),s=(b.calculateContentSize(e,t,i).width-i.width*t.width)/(i.width+1);let n=[];for(let o=0;o<a;o++){const e=Math.floor(o/i.width),a={x:e*s+o%i.width*t.width,y:e*t.height};n.push(a)}return n}}class m{static snapValueToRange(e,t,a){return e<t?t:e>a?a:e}static isValueInRange(e,t,a){return e>=t&&e<=a}}class O{static getRatio(e){return e?e.width/e.height:null}static intersect(e,t){return e&&t?!(t.x>e.x+e.width||t.x+t.width<e.x||t.y>e.y+e.height||t.y+t.height<e.y):null}static isPointInside(e,t){return e&&t?e.x<t.x&&e.x+e.width>t.x&&e.y<t.y&&e.y+e.height>t.y:null}static getRectWithCenterAndSize(e,t){return{x:e.x-.5*t.width,y:e.y-.5*t.height,...t}}static fitInsideRectWithRatio(e,t){if(O.getRatio(e)<t){const a=e.width/t;return{x:e.x,y:e.y+(e.height-a)/2,width:e.width,height:a}}{const a=e.height*t;return{x:e.x+(e.width-a)/2,y:e.y,width:a,height:e.height}}}static resizeRect(e,t,a){const i={...e};switch(t){case l.RIGHT:i.width+=a.x;break;case l.BOTTOM_RIGHT:i.width+=a.x,i.height+=a.y;break;case l.BOTTOM:i.height+=a.y;break;case l.TOP_RIGHT:i.width+=a.x,i.y+=a.y,i.height-=a.y;break;case l.TOP:i.y+=a.y,i.height-=a.y;break;case l.TOP_LEFT:i.x+=a.x,i.width-=a.x,i.y+=a.y,i.height-=a.y;break;case l.LEFT:i.x+=a.x,i.width-=a.x;break;case l.BOTTOM_LEFT:i.x+=a.x,i.width-=a.x,i.height+=a.y}return i.width<0&&(i.x=i.x+i.width,i.width=-i.width),i.height<0&&(i.y=i.y+i.height,i.height=-i.height),i}static translate(e,t){return{...e,x:e.x+t.x,y:e.y+t.y}}static expand(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width+2*t.x,height:e.height+2*t.y}}static scaleRect(e,t){return{x:e.x*t,y:e.y*t,width:e.width*t,height:e.height*t}}static mapRectToAnchors(e){return[{type:l.TOP_LEFT,position:{x:e.x,y:e.y}},{type:l.TOP,position:{x:e.x+.5*e.width,y:e.y}},{type:l.TOP_RIGHT,position:{x:e.x+e.width,y:e.y}},{type:l.LEFT,position:{x:e.x,y:e.y+.5*e.height}},{type:l.RIGHT,position:{x:e.x+e.width,y:e.y+.5*e.height}},{type:l.BOTTOM_LEFT,position:{x:e.x,y:e.y+e.height}},{type:l.BOTTOM,position:{x:e.x+.5*e.width,y:e.y+e.height}},{type:l.BOTTOM_RIGHT,position:{x:e.x+e.width,y:e.y+e.height}}]}static snapPointToRect(e,t){return O.isPointInside(t,e)?e:{x:m.snapValueToRange(e.x,t.x,t.x+t.width),y:m.snapValueToRange(e.y,t.y,t.y+t.height)}}}var I=a(2);class A extends s.a.Component{constructor(e){super(e),this.gridSize=void 0,this.contentSize=void 0,this.childAnchors=void 0,this.scrollbars=void 0,this.calculate=(e,t,a)=>{this.gridSize=b.calculateGridSize(e,t,a),this.contentSize=b.calculateContentSize(e,t,this.gridSize),this.childAnchors=b.calculateAnchorPoints(e,t,a)},this.getVirtualListStyle=()=>({position:"relative",width:this.props.size.width,height:this.props.size.height}),this.getVirtualListContentStyle=()=>({width:this.contentSize.width,height:this.contentSize.height}),this.onScrollStart=()=>{this.setState({isScrolling:!0})},this.onScrollStop=()=>{this.setState({isScrolling:!1})},this.onScroll=e=>{this.setState({viewportRect:{x:e.scrollLeft,y:e.scrollTop,width:this.props.size.width,height:this.props.size.height}})},this.getChildren=()=>{const{viewportRect:e,isScrolling:t}=this.state,{overScanHeight:a,childSize:i}=this.props,s=a||0,n={x:e.x,y:e.y-s,width:e.width,height:e.height+2*s};return this.childAnchors.reduce(((e,a,s)=>{const o=Object.assign(a,i),r=O.intersect(n,o);if(r){const n={position:"absolute",left:a.x,top:a.y,width:i.width,height:i.height};return e.concat(this.props.childRender(s,t,r,n))}return e}),[])},this.state={viewportRect:null,isScrolling:!1}}componentDidMount(){const{size:e,childSize:t,childCount:a}=this.props;this.calculate(e,t,a),this.setState({viewportRect:{x:0,y:0,width:this.props.size.width,height:this.props.size.height}})}componentWillUpdate(e,t,a){const{size:i,childSize:s,childCount:n}=e;this.props.size.height===i.height&&this.props.size.width===i.width&&this.props.childCount===n||(this.calculate(i,s,n),this.setState({viewportRect:{x:this.scrollbars.getValues().scrollLeft,y:this.scrollbars.getValues().scrollTop,width:i.width,height:i.height}}))}render(){const e=!!this.props.size&&!!this.props.childSize&&!!this.gridSize;return Object(I.jsx)("div",{className:"VirtualList",style:this.getVirtualListStyle(),children:Object(I.jsx)(p.a,{ref:e=>this.scrollbars=e,onScrollFrame:this.onScroll,onScrollStart:this.onScrollStart,onScrollStop:this.onScrollStop,autoHide:!0,children:e&&Object(I.jsx)("div",{className:"VirtualListContent",style:this.getVirtualListContentStyle(),children:this.getChildren()})})})}}var P=a(33),v=a.n(P),j=a(137);class E{static add(e){E.queue.push((async()=>await e))}static run(){setTimeout((()=>E.runQueue()),10)}static addAndRun(e){E.add(e),E.run()}static async runQueue(){E.isRunning||(E.isRunning=!0,await E.runTasks(),E.isRunning=!1)}static async runTasks(){for(;E.queue.length>0;){const e=E.queue.shift();await e()}}}E.queue=[],E.isRunning=!1;var C=a(21);class T{static storeImage(e,t){T.repository[e]=t}static storeImages(e,t){Object(C.zip)(e,t).forEach((e=>{T.storeImage(...e)}))}static getById(e){return T.repository[e]}}T.repository={};let L=function(e){return e.UPDATE_SUGGESTED_LABEL_LIST="@@UPDATE_SUGGESTED_LABEL_LIST",e.UPDATE_REJECTED_SUGGESTED_LABEL_LIST="@@UPDATE_REJECTED_SUGGESTED_LABEL_LIST",e.UPDATE_OBJECT_DETECTOR_STATUS="@@UPDATE_OBJECT_DETECTOR_STATUS",e.UPDATE_POSE_DETECTOR_STATUS="@@UPDATE_POSE_DETECTOR_STATUS",e.UPDATE_DISABLED_AI_FLAG="@@UPDATE_DISABLED_AI_FLAG",e.UPDATE_PROJECT_DATA="@@UPDATE_PROJECT_DATA",e.UPDATE_WINDOW_SIZE="@@UPDATE_WINDOW_SIZE",e.UPDATE_ACTIVE_POPUP_TYPE="@@UPDATE_ACTIVE_POPUP_TYPE",e.UPDATE_CUSTOM_CURSOR_STYLE="@@UPDATE_CUSTOM_CURSOR_STYLE",e.UPDATE_CONTEXT="@@UPDATE_CONTEXT",e.UPDATE_PREVENT_CUSTOM_CURSOR_STATUS="@@UPDATE_PREVENT_CUSTOM_CURSOR_STATUS",e.UPDATE_IMAGE_DRAG_MODE_STATUS="@@UPDATE_IMAGE_DRAG_MODE_STATUS",e.UPDATE_CROSS_HAIR_VISIBLE_STATUS="@@UPDATE_CROSS_HAIR_VISIBLE_STATUS",e.UPDATE_ZOOM="@@UPDATE_ZOOM",e.UPDATE_CONFIG_FOLDER="@@UPDATE_CONFIG_FOLDER",e.UPDATE_ERROR_MSG="@@UPDATE_ERROR_MSG",e.UPDATE_ACTIVE_IMAGE_INDEX="@@UPDATE_ACTIVE_IMAGE_INDEX",e.UPDATE_IMAGE_DATA_BY_ID="@@UPDATE_IMAGE_DATA_BY_ID",e.ADD_IMAGES_DATA="@@ADD_IMAGES_DATA",e.UPDATE_IMAGES_DATA="@@UPDATE_IMAGES_DATA",e.UPDATE_ACTIVE_LABEL_NAME_ID="@@UPDATE_ACTIVE_LABEL_NAME_ID",e.UPDATE_ACTIVE_LABEL_TYPE="@@UPDATE_ACTIVE_LABEL_TYPE",e.UPDATE_ACTIVE_LABEL_ID="@@UPDATE_ACTIVE_LABEL_ID",e.UPDATE_HIGHLIGHTED_LABEL_ID="@@UPDATE_HIGHLIGHTED_LABEL_ID",e.UPDATE_LABEL_NAMES="@@UPDATE_LABEL_NAMES",e.UPDATE_FIRST_LABEL_CREATED_FLAG="@@UPDATE_FIRST_LABEL_CREATED_FLAG",e.UPDATE_CAMERA_IDS="@@UPDATE_CAMERA_IDS",e.UPDATE_MQTT_DATA="@@UPDATE_MQTT_DATA",e.UPDATE_OVERLAP_THRESHOLD="@@UPDATE_OVERLAP_THRESHOLD",e.UPDATE_RESOLUTION="@@UPDATE_RESOLUTION",e.UPDATE_SENSOR_ID="@@UPDATE_SENSOR_ID",e}({});function x(e){return{type:L.UPDATE_ACTIVE_IMAGE_INDEX,payload:{activeImageIndex:e}}}function y(e){return{type:L.UPDATE_ACTIVE_LABEL_NAME_ID,payload:{activeLabelNameId:e}}}function S(e){return{type:L.UPDATE_ACTIVE_LABEL_ID,payload:{activeLabelId:e}}}function f(e){return{type:L.UPDATE_HIGHLIGHTED_LABEL_ID,payload:{highlightedLabelId:e}}}function w(e){return{type:L.UPDATE_ACTIVE_LABEL_TYPE,payload:{activeLabelType:e}}}function D(e,t){return{type:L.UPDATE_IMAGE_DATA_BY_ID,payload:{id:e,newImageData:t}}}function N(e){return{type:L.ADD_IMAGES_DATA,payload:{imageData:e}}}function R(e){return{type:L.UPDATE_IMAGES_DATA,payload:{imageData:e}}}function _(e){return{type:L.UPDATE_LABEL_NAMES,payload:{labels:e}}}function M(e){return{type:L.UPDATE_FIRST_LABEL_CREATED_FLAG,payload:{firstLabelCreatedFlag:e}}}const B="http://192.168.10.49:5000/",V=B+"api/image/list",U=B+"api/image/run_feed",F=B+"api/annotation/list",z=B+"api/image/save_annotations",k=B+"api/image/delete_annotations",G=B+"api/image/delete_all_files";class H{static loadImage(e){return new Promise(((t,a)=>{const i=new Image;i.src=B+e,i.onload=()=>t(i),i.onerror=a}))}static loadImages(e){return new Promise(((t,a)=>{const i=e.map((e=>H.loadImage(e)));Promise.all(i).then((e=>t(e))).catch((e=>a(e)))}))}static readFile(e){return new Promise(((t,a)=>{let i=new FileReader;i.onloadend=e=>{t(e.target.result)},i.onerror=a,i.readAsText(e)}))}static readFiles(e){return new Promise(((t,a)=>{const i=e.map((e=>H.readFile(e)));Promise.all(i).then((e=>t(e))).catch((e=>a(e)))}))}static extractFileExtension(e){const t=e.split(".");return t.length>1?t[1]:null}static extractFileName(e){return e.split(".")[0]}}a(332);class W{static getSuggestedLabelList(){return Ii.getState().ai.suggestedLabelList}static getRejectedSuggestedLabelList(){return Ii.getState().ai.rejectedSuggestedLabelList}static isAIObjectDetectorModelLoaded(){return Ii.getState().ai.isObjectDetectorLoaded}static isAIPoseDetectorModelLoaded(){return Ii.getState().ai.isPoseDetectorLoaded}static isAIDisabled(){return Ii.getState().ai.isAIDisabled}}class Y{static getLeadingColor(){return W.isAIObjectDetectorModelLoaded()||W.isAIPoseDetectorModelLoaded()?g.PRIMARY_COLOR:g.SECONDARY_COLOR}}class Z extends s.a.Component{constructor(e){super(e),this.isLoading=!1,this.loadImage=async(e,t)=>{if(e.loadStatus){const t=T.getById(e.id);this.state.image!==t&&this.setState({image:t})}else if(!t||!this.isLoading){this.isLoading=!0;const t=t=>this.saveLoadedImage(t,e);H.loadImage(e.fileName).then((e=>t(e))).catch((e=>this.handleLoadImageError()))}},this.saveLoadedImage=(e,t)=>{t.loadStatus=!0,this.props.updateImageDataById(t.id,t),T.storeImage(t.id,e),t.id===this.props.imageData.id&&(this.setState({image:e}),this.isLoading=!1)},this.getStyle=()=>{const{size:e}=this.props,t={x:.15*e.width,y:.15*e.height,width:.7*e.width,height:.7*e.height},a={x:0,y:0,width:this.state.image.width,height:this.state.image.height},i=O.getRatio(a),s=O.fitInsideRectWithRatio(t,i);return{width:s.width,height:s.height,left:s.x,top:s.y}},this.handleLoadImageError=()=>{},this.getClassName=()=>v()("ImagePreview",{selected:this.props.isSelected}),this.state={image:null}}componentDidMount(){E.addAndRun(this.loadImage(this.props.imageData,this.props.isScrolling))}componentWillUpdate(e,t,a){this.props.imageData.id!==e.imageData.id&&(e.imageData.loadStatus?E.addAndRun(this.loadImage(e.imageData,e.isScrolling)):this.setState({image:null})),this.props.isScrolling&&!e.isScrolling&&E.addAndRun(this.loadImage(e.imageData,!1))}shouldComponentUpdate(e,t,a){return this.props.imageData.id!==e.imageData.id||this.state.image!==t.image||this.props.isSelected!==e.isSelected||this.props.isChecked!==e.isChecked}render(){const{isChecked:e,style:t,onClick:a}=this.props;return Object(I.jsx)("div",{className:this.getClassName(),style:t,onClick:a||void 0,children:this.state.image?[Object(I.jsxs)("div",{className:"Foreground",style:this.getStyle(),children:[Object(I.jsx)("img",{className:"Image",draggable:!1,src:this.state.image.src,alt:this.state.image.alt,style:{...this.getStyle(),left:0,top:0}}),e&&Object(I.jsx)("img",{className:"CheckBox",draggable:!1,src:"ico/ok.png",alt:"checkbox"})]},"Foreground"),Object(I.jsx)("div",{className:"Background",style:this.getStyle()},"Background")]:Object(I.jsx)(j.ClipLoader,{size:30,color:Y.getLeadingColor(),loading:!0})})}}const X={updateImageDataById:D};var J=Object(r.b)((e=>({})),X)(Z);a(333);let K=function(e){return e.EDITOR="EDITOR",e.LEFT_NAVBAR="LEFT_NAVBAR",e.RIGHT_NAVBAR="RIGHT_NAVBAR",e.POPUP="POPUP",e.DROPDOWN="DROPDOWN",e}({});function q(e){return{type:L.UPDATE_ACTIVE_POPUP_TYPE,payload:{activePopupType:e}}}function Q(e){return{type:L.UPDATE_CUSTOM_CURSOR_STYLE,payload:{customCursorStyle:e}}}function $(e){return{type:L.UPDATE_PREVENT_CUSTOM_CURSOR_STATUS,payload:{preventCustomCursor:e}}}function ee(e){return{type:L.UPDATE_PROJECT_DATA,payload:{projectData:e}}}class te{}te.editor=void 0,te.canvas=void 0,te.mousePositionIndicator=void 0,te.cursor=void 0,te.viewPortScrollbars=void 0,te.image=void 0,te.primaryRenderingEngine=void 0,te.supportRenderingEngine=void 0,te.viewPortHelper=void 0,te.isLoading=!1,te.viewPortActionsDisabled=!1,te.mousePositionOnViewPortContent=void 0,te.viewPortSize=void 0,te.defaultRenderImageRect=void 0;class ae{static deg2rad(e){return e*Math.PI/180}static rad2deg(e){return 180*e/Math.PI}}class ie{static clearCanvas(e){e.getContext("2d").clearRect(0,0,e.width,e.height)}static drawLine(e,t,a){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#111111",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,n=e.getContext("2d");n.save(),n.strokeStyle=i,n.lineWidth=s,n.lineCap="round",n.beginPath(),n.moveTo(t.x,t.y),n.lineTo(a.x+1,a.y+1),n.stroke(),n.restore()}static drawRect(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#fff",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=e.getContext("2d");s.save(),s.strokeStyle=a,s.lineWidth=i,s.beginPath(),s.rect(t.x,t.y,t.width,t.height),s.stroke(),s.restore()}static drawRectWithFill(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#fff",i=e.getContext("2d");i.save(),i.fillStyle=a,i.beginPath(),i.rect(t.x,t.y,t.width,t.height),i.fill(),i.restore()}static shadeEverythingButRect(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rgba(0, 0, 0, 0.7)",i=e.getContext("2d");i.save(),i.fillStyle=a,i.fillRect(0,0,e.width,e.height),i.globalCompositeOperation="destination-out",i.fillRect(t.x,t.y,t.width,t.height),i.restore()}static drawCircleWithFill(e,t,a){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#ffffff";const s=e.getContext("2d");s.save();const n=ae.deg2rad(0),o=ae.deg2rad(360);s.fillStyle=i,s.beginPath(),s.arc(t.x,t.y,a,n,o,!1),s.fill(),s.restore()}static drawCircle(e,t,a,i,s){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"#ffffff",r=e.getContext("2d"),l=ae.deg2rad(i),c=ae.deg2rad(s);r.save(),r.strokeStyle=o,r.lineWidth=n,r.beginPath(),r.arc(t.x,t.y,a,l,c,!1),r.stroke(),r.restore()}static drawPolygon(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#fff",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=e.getContext("2d");s.save(),s.strokeStyle=a,s.lineWidth=i,s.beginPath(),s.moveTo(t[0].x,t[0].y);for(let n=1;n<t.length;n++)s.lineTo(t[n].x,t[n].y);s.closePath(),s.stroke(),s.restore()}static drawPolygonWithFill(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#fff",i=e.getContext("2d");i.save(),i.fillStyle=a,i.beginPath(),i.moveTo(t[0].x,t[0].y);for(let s=1;s<t.length;s++)i.lineTo(t[s].x,t[s].y);i.closePath(),i.fill(),i.restore()}static drawText(e,t,a,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#ffffff",n=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"center",r=e.getContext("2d");r.save(),r.fillStyle=s,r.textAlign=o,r.textBaseline="middle",r.font=(n?"bold ":"")+a+"px Arial",r.fillText(t,i.x,i.y),r.restore()}static getRandomRGBColor(){return"rgb("+Math.round(255*Math.random())+","+Math.round(255*Math.random())+","+Math.round(255*Math.random())+")"}static hexToRGB(e,t){const a=parseInt(e.slice(1,3),16),i=parseInt(e.slice(3,5),16),s=parseInt(e.slice(5,7),16);return t?"rgba("+a+", "+i+", "+s+", "+t+")":"rgb("+a+", "+i+", "+s+")"}}class se{static equals(e,t){return e.x===t.x&&e.y===t.y}static add(e,t){return{x:e.x+t.x,y:e.y+t.y}}static subtract(e,t){return{x:e.x-t.x,y:e.y-t.y}}static multiply(e,t){return{x:e.x*t,y:e.y*t}}}class ne{constructor(){this.lineThickness=2,this.lineActiveColor=g.PRIMARY_COLOR,this.lineInactiveColor="#fff",this.crossHairLineColor="#fff",this.crossHairPadding=25,this.anchorSize={width:g.RESIZE_HANDLE_DIMENSION_PX,height:g.RESIZE_HANDLE_DIMENSION_PX},this.anchorHoverSize={width:g.RESIZE_HANDLE_HOVER_DIMENSION_PX,height:g.RESIZE_HANDLE_HOVER_DIMENSION_PX},this.suggestedAnchorDetectionSize={width:100,height:100},this.activeAnchorColor=g.SECONDARY_COLOR,this.inactiveAnchorColor=g.DARK_THEME_SECOND_COLOR}}let oe=function(e){return e.DEFAULT="DEFAULT",e.MOVE="MOVE",e.RESIZE="RESIZE",e.ADD="ADD",e.CANCEL="CANCEL",e.CLOSE="CLOSE",e.GRAB="GRAB",e.GRABBING="GRABBING",e}({});class re{static getLabelNames(){return Ii.getState().labels.labels}static getActiveLabelNameId(){return Ii.getState().labels.activeLabelNameId}static getActiveLabelType(){return Ii.getState().labels.activeLabelType}static getImagesData(){return Ii.getState().labels.imagesData}static getActiveImageIndex(){return Ii.getState().labels.activeImageIndex}static getActiveImageData(){const e=re.getActiveImageIndex();return null===e?null:re.getImageDataByIndex(e)}static getImageDataByIndex(e){return re.getImagesData()[e]}static getImageDataById(e){const t=re.getImagesData();return Object(C.find)(t,{id:e})}static getActiveLabelId(){return Ii.getState().labels.activeLabelId}static getHighlightedLabelId(){return Ii.getState().labels.highlightedLabelId}static getActiveRectLabel(){const e=re.getActiveLabelId();return null===e?null:Object(C.find)(re.getActiveImageData().labelRects,{id:e})}static getActivePointLabel(){const e=re.getActiveLabelId();return null===e?null:Object(C.find)(re.getActiveImageData().labelPoints,{id:e})}static getActivePolygonLabel(){const e=re.getActiveLabelId();return null===e?null:Object(C.find)(re.getActiveImageData().labelPolygons,{id:e})}static getActiveLineLabel(){const e=re.getActiveLabelId();return null===e?null:Object(C.find)(re.getActiveImageData().labelLines,{id:e})}}let le=function(e){return e.RESIZE="resize",e.MOUSE_UP="mouseup",e.MOUSE_DOWN="mousedown",e.MOUSE_MOVE="mousemove",e.MOUSE_WHEEL="wheel",e.KEY_DOWN="keydown",e.KEY_PRESS="keypress",e.KEY_UP="keyup",e.FOCUS="focus",e}({});class ce{static getEventType(e){if(!e)return null;switch(e.type){case le.MOUSE_DOWN:return le.MOUSE_DOWN;case le.MOUSE_UP:return le.MOUSE_UP;case le.MOUSE_MOVE:return le.MOUSE_MOVE;default:return null}}}class de{constructor(e){this.canvas=void 0,this.labelType=void 0,this.canvas=e}update(e){if(e.event)switch(ce.getEventType(e.event)){case le.MOUSE_MOVE:this.mouseMoveHandler(e);break;case le.MOUSE_UP:this.mouseUpHandler(e);break;case le.MOUSE_DOWN:this.mouseDownHandler(e)}}}class ge{static getDistanceFromLine(e,t){if(e.start.x!==e.end.x||e.start.y!==e.end.y){return Math.abs((e.end.y-e.start.y)*t.x-(e.end.x-e.start.x)*t.y+e.end.x*e.start.y-e.end.y*e.start.x)/Math.sqrt(Math.pow(e.end.y-e.start.y,2)+Math.pow(e.end.x-e.start.x,2))}return null}static getCenter(e){return{x:(e.start.x+e.end.x)/2,y:(e.start.y+e.end.y)/2}}static getPoints(e){return[e.start,e.end]}}class he{static calculateImageScale(e){return e.realImageSize.width/e.viewPortContentImageRect.width}static isMouseOverImage(e){return O.isPointInside(e.viewPortContentImageRect,e.mousePositionOnViewPortContent)}static isMouseOverCanvas(e){return O.isPointInside({x:0,y:0,...e.viewPortContentSize},e.mousePositionOnViewPortContent)}static transferPointFromImageToViewPortContent(e,t){const a=he.calculateImageScale(t);return se.add(se.multiply(e,1/a),t.viewPortContentImageRect)}static transferPolygonFromImageToViewPortContent(e,t){return e.map((e=>he.transferPointFromImageToViewPortContent(e,t)))}static transferLineFromImageToViewPortContent(e,t){return{start:he.transferPointFromImageToViewPortContent(e.start,t),end:he.transferPointFromImageToViewPortContent(e.end,t)}}static transferPointFromViewPortContentToImage(e,t){const a=he.calculateImageScale(t);return se.multiply(se.subtract(e,t.viewPortContentImageRect),a)}static transferPolygonFromViewPortContentToImage(e,t){return e.map((e=>he.transferPointFromViewPortContentToImage(e,t)))}static transferLineFromViewPortContentToImage(e,t){return{start:he.transferPointFromViewPortContentToImage(e.start,t),end:he.transferPointFromViewPortContentToImage(e.end,t)}}static transferRectFromViewPortContentToImage(e,t){const a=he.calculateImageScale(t);return O.translate(O.scaleRect(e,1/a),t.viewPortContentImageRect)}static transferRectFromImageToViewPortContent(e,t){const a=he.calculateImageScale(t),i={x:-t.viewPortContentImageRect.x,y:-t.viewPortContentImageRect.y};return O.scaleRect(O.translate(e,i),a)}static wrapDefaultCursorStyleInCancel(e){O.isPointInside(e.viewPortContentImageRect,e.mousePositionOnViewPortContent)?Ii.dispatch(Q(oe.DEFAULT)):Ii.dispatch(Q(oe.CANCEL))}static setValueBetweenPixels(e){return Math.floor(e)+.5}static setPointBetweenPixels(e){return{x:he.setValueBetweenPixels(e.x),y:he.setValueBetweenPixels(e.y)}}static setRectBetweenPixels(e){const t={x:e.x,y:e.y},a={x:e.x+e.width,y:e.y+e.height},i=he.setPointBetweenPixels(t),s=he.setPointBetweenPixels(a);return{x:i.x,y:i.y,width:s.x-i.x,height:s.y-i.y}}static isMouseOverLine(e,t,a){const i=Math.min(t.start.x,t.end.x),s=Math.max(t.start.x,t.end.x),n=Math.min(t.start.y,t.end.y),o=Math.max(t.start.y,t.end.y);return i-a<=e.x&&s+a>=e.x&&n-a<=e.y&&o+a>=e.y&&ge.getDistanceFromLine(t,e)<a}static isMouseOverAnchor(e,t,a){return e&&t?O.isPointInside(O.getRectWithCenterAndSize(t,a),e):null}}class ue{static getActivePopupType(){return Ii.getState().general.activePopupType}static getActiveContext(){return Ii.getState().general.activeContext}static getPreventCustomCursorStatus(){return Ii.getState().general.preventCustomCursor}static getImageDragModeStatus(){return Ii.getState().general.imageDragMode}static getCrossHairVisibleStatus(){return Ii.getState().general.crossHairVisible}static getCustomCursorStyle(){return Ii.getState().general.customCursorStyle}static getProjectName(){return Ii.getState().general.projectData.name}static getProjectType(){return Ii.getState().general.projectData.type}static getZoom(){return Ii.getState().general.zoom}}let pe=function(e){return e.ACCEPTED="ACCEPTED",e.REJECTED="REJECTED",e.UNDECIDED="UNDECIDED",e}({});var be=a(46),me=a.n(be);class Oe{static createLabelName(e){return{id:me()(),name:e}}static createLabelRect(e,t){return{id:me()(),labelId:e,rect:t,isCreatedByAI:!1,status:pe.ACCEPTED,suggestedLabel:null}}static createLabelPolygon(e,t){return{id:me()(),labelId:e,vertices:t}}static convertLabelNamesListToMap(e){return e.reduce(((e,t)=>(e[t.id]=t.name,e)),{})}static convertMapToLabelNamesList(e){const t=[];return Object.keys(e).forEach((a=>{e[a]&&t.push({id:a,name:e[a]})})),t}static labelNamesIdsDiff(e,t){return e.reduce(((e,a)=>(Object(C.find)(t,{id:a.id})||e.push(a.id),e)),[])}}class Ie extends de{constructor(e){super(e),this.config=new ne,this.startCreateRectPoint=void 0,this.startResizeRectAnchor=void 0,this.mouseDownHandler=e=>{const t=he.isMouseOverImage(e);if(he.isMouseOverCanvas(e)){const a=this.getRectUnderMouse(e);if(a){const t=this.calculateRectRelativeToActiveImage(a.rect,e),i=this.getAnchorUnderMouseByRect(t,e.mousePositionOnViewPortContent,e.viewPortContentImageRect);i&&a.status===pe.ACCEPTED?(Ii.dispatch(S(a.id)),this.startRectResize(i)):re.getHighlightedLabelId()?Ii.dispatch(S(re.getHighlightedLabelId())):this.startRectCreation(e.mousePositionOnViewPortContent)}else t&&this.startRectCreation(e.mousePositionOnViewPortContent)}},this.mouseUpHandler=e=>{if(e.viewPortContentImageRect){const t=O.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),a=re.getActiveRectLabel();if(this.startCreateRectPoint&&!se.equals(this.startCreateRectPoint,t)){const a=Math.min(this.startCreateRectPoint.x,t.x),i=Math.min(this.startCreateRectPoint.y,t.y),s={x:a,y:i,width:Math.max(this.startCreateRectPoint.x,t.x)-a,height:Math.max(this.startCreateRectPoint.y,t.y)-i};this.addRectLabel(he.transferRectFromImageToViewPortContent(s,e))}if(this.startResizeRectAnchor&&a){const i=this.calculateRectRelativeToActiveImage(a.rect,e),s=se.add(this.startResizeRectAnchor.position,e.viewPortContentImageRect),n=se.subtract(t,s),o=O.resizeRect(i,this.startResizeRectAnchor.type,n),r=he.calculateImageScale(e),l=O.scaleRect(o,r),c=re.getActiveImageData();c.labelRects=c.labelRects.map((e=>e.id===a.id?{...e,rect:l}:e)),Ii.dispatch(D(c.id,c))}}this.endRectTransformation()},this.mouseMoveHandler=e=>{if(e.viewPortContentImageRect&&e.mousePositionOnViewPortContent){if(he.isMouseOverImage(e)&&!this.startResizeRectAnchor){const t=this.getRectUnderMouse(e);t&&!this.isInProgress()?re.getHighlightedLabelId()!==t.id&&Ii.dispatch(f(t.id)):null!==re.getHighlightedLabelId()&&Ii.dispatch(f(null))}}},this.addRectLabel=e=>{const t=re.getActiveLabelNameId(),a=re.getActiveImageData(),i=Oe.createLabelRect(t,e);a.labelRects.push(i),Ii.dispatch(D(a.id,a)),Ii.dispatch(M(!0)),Ii.dispatch(S(i.id))},this.labelType=h.RECT}render(e){const t=re.getActiveLabelId(),a=re.getActiveImageData();a&&(a.labelRects.forEach((a=>{a.status===pe.ACCEPTED&&a.id===t?this.drawActiveRect(a,e):this.drawInactiveRect(a,e)})),this.drawCurrentlyCreatedRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),this.updateCursorStyle(e))}drawCurrentlyCreatedRect(e,t){if(this.startCreateRectPoint){const a=O.snapPointToRect(e,t),i={x:this.startCreateRectPoint.x,y:this.startCreateRectPoint.y,width:a.x-this.startCreateRectPoint.x,height:a.y-this.startCreateRectPoint.y},s=he.setRectBetweenPixels(i);ie.drawRect(this.canvas,s,this.config.lineActiveColor,this.config.lineThickness)}}drawInactiveRect(e,t){const a=he.transferRectFromViewPortContentToImage(e.rect,t),i=re.getHighlightedLabelId(),s=e.status===pe.ACCEPTED&&e.id===i;this.renderRect(a,s)}drawActiveRect(e,t){let a=this.calculateRectRelativeToActiveImage(e.rect,t);if(this.startResizeRectAnchor){const e=se.add(this.startResizeRectAnchor.position,t.viewPortContentImageRect),i=O.snapPointToRect(t.mousePositionOnViewPortContent,t.viewPortContentImageRect),s=se.subtract(i,e);a=O.resizeRect(a,this.startResizeRectAnchor.type,s)}const i=O.translate(a,t.viewPortContentImageRect);this.renderRect(i,!0)}renderRect(e,t){const a=he.setRectBetweenPixels(e),i=t?this.config.lineActiveColor:this.config.lineInactiveColor;if(ie.drawRect(this.canvas,a,i,this.config.lineThickness),t){O.mapRectToAnchors(e).map((e=>e.position)).forEach((e=>{const t=O.getRectWithCenterAndSize(e,this.config.anchorSize),a=he.setRectBetweenPixels(t);ie.drawRectWithFill(this.canvas,a,this.config.activeAnchorColor)}))}}updateCursorStyle(e){if(this.canvas&&e.mousePositionOnViewPortContent&&!ue.getImageDragModeStatus()){const t=this.getRectUnderMouse(e);if(this.getAnchorUnderMouse(e)&&t&&t.status===pe.ACCEPTED||this.startResizeRectAnchor)return void Ii.dispatch(Q(oe.MOVE));he.isMouseOverCanvas(e)?(!he.isMouseOverImage(e)&&this.startCreateRectPoint?Ii.dispatch(Q(oe.MOVE)):he.wrapDefaultCursorStyleInCancel(e),this.canvas.style.cursor="none"):this.canvas.style.cursor="default"}}isInProgress(){return!!this.startCreateRectPoint||!!this.startResizeRectAnchor}calculateRectRelativeToActiveImage(e,t){const a=he.calculateImageScale(t);return O.scaleRect(e,1/a)}getRectUnderMouse(e){const t=re.getActiveRectLabel();if(t&&this.isMouseOverRectEdges(t.rect,e))return t;const a=re.getActiveImageData().labelRects;for(let i=0;i<a.length;i++)if(this.isMouseOverRectEdges(a[i].rect,e))return a[i];return null}isMouseOverRectEdges(e,t){const a=O.translate(this.calculateRectRelativeToActiveImage(e,t),t.viewPortContentImageRect),i={x:this.config.anchorHoverSize.width/2,y:this.config.anchorHoverSize.height/2},s=O.expand(a,i),n={x:-this.config.anchorHoverSize.width/2,y:-this.config.anchorHoverSize.height/2},o=O.expand(a,n);return O.isPointInside(s,t.mousePositionOnViewPortContent)&&!O.isPointInside(o,t.mousePositionOnViewPortContent)}getAnchorUnderMouseByRect(e,t,a){const i=O.mapRectToAnchors(e);for(let s=0;s<i.length;s++){const e=O.translate(O.getRectWithCenterAndSize(i[s].position,this.config.anchorHoverSize),a);if(t&&O.isPointInside(e,t))return i[s]}return null}getAnchorUnderMouse(e){const t=re.getActiveImageData().labelRects;for(let a=0;a<t.length;a++){const i=this.calculateRectRelativeToActiveImage(t[a].rect,e),s=this.getAnchorUnderMouseByRect(i,e.mousePositionOnViewPortContent,e.viewPortContentImageRect);if(s)return s}return null}startRectCreation(e){this.startCreateRectPoint=e,Ii.dispatch(S(null)),De.setViewPortActionsDisabledStatus(!0)}startRectResize(e){this.startResizeRectAnchor=e,De.setViewPortActionsDisabledStatus(!0)}endRectTransformation(){this.startCreateRectPoint=null,this.startResizeRectAnchor=null,De.setViewPortActionsDisabledStatus(!1)}}class Ae{static getMousePositionOnCanvasFromEvent(e,t){if(t&&e){const a=t.getBoundingClientRect();return{x:e.clientX-a.left,y:e.clientY-a.top}}return null}static getClientRect(e){if(e){const t=e.getBoundingClientRect();return{x:t.left,y:t.top,width:t.width,height:t.height}}return null}static getSize(e){if(e){const t=e.getBoundingClientRect();return{width:t.width,height:t.height}}return null}}class Pe extends de{constructor(e){super(e),this.config=new ne,this.addPointLabel=e=>{const t=re.getActiveLabelNameId(),a=re.getActiveImageData(),i={id:me()(),labelId:t,point:e,isCreatedByAI:!1,status:pe.ACCEPTED,suggestedLabel:null};a.labelPoints.push(i),Ii.dispatch(D(a.id,a)),Ii.dispatch(M(!0)),Ii.dispatch(S(i.id))},this.labelType=h.POINT}mouseDownHandler(e){const t=he.isMouseOverImage(e);if(he.isMouseOverCanvas(e)){const a=this.getLabelPointUnderMouse(e.mousePositionOnViewPortContent,e);if(a){const t=he.transferPointFromImageToViewPortContent(a.point,e),i=he.setPointBetweenPixels(t),s=O.getRectWithCenterAndSize(i,this.config.anchorHoverSize);if(O.isPointInside(s,e.mousePositionOnViewPortContent))return Ii.dispatch(S(a.id)),void De.setViewPortActionsDisabledStatus(!0);{Ii.dispatch(S(null));const t=he.transferPointFromViewPortContentToImage(e.mousePositionOnViewPortContent,e);this.addPointLabel(t)}}else if(t){const t=he.transferPointFromViewPortContentToImage(e.mousePositionOnViewPortContent,e);this.addPointLabel(t)}}}mouseUpHandler(e){if(this.isInProgress()){const t=re.getActivePointLabel(),a=O.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),i=he.transferPointFromViewPortContentToImage(a,e),s=re.getActiveImageData();s.labelPoints=s.labelPoints.map((e=>e.id===t.id?{...e,point:i}:e)),Ii.dispatch(D(s.id,s))}De.setViewPortActionsDisabledStatus(!1)}mouseMoveHandler(e){if(he.isMouseOverImage(e)){const t=this.getLabelPointUnderMouse(e.mousePositionOnViewPortContent,e);t?re.getHighlightedLabelId()!==t.id&&Ii.dispatch(f(t.id)):null!==re.getHighlightedLabelId()&&Ii.dispatch(f(null))}}render(e){const t=re.getActiveLabelId(),a=re.getHighlightedLabelId(),i=re.getActiveImageData();i&&i.labelPoints.forEach((i=>{if(i.id===t)if(this.isInProgress()){const t=O.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),a=he.setPointBetweenPixels(t);ie.drawCircleWithFill(this.canvas,a,g.RESIZE_HANDLE_DIMENSION_PX/2,this.config.activeAnchorColor)}else this.renderPoint(i,!0,e);else this.renderPoint(i,i.id===t||i.id===a,e)})),this.updateCursorStyle(e)}renderPoint(e,t,a){const i=he.transferPointFromImageToViewPortContent(e.point,a),s=he.setPointBetweenPixels(i),n=t?this.config.activeAnchorColor:this.config.inactiveAnchorColor;ie.drawCircleWithFill(this.canvas,s,g.RESIZE_HANDLE_DIMENSION_PX/2,n)}updateCursorStyle(e){if(this.canvas&&e.mousePositionOnViewPortContent&&!ue.getImageDragModeStatus()){const t=this.getLabelPointUnderMouse(e.mousePositionOnViewPortContent,e);if(t&&t.status===pe.ACCEPTED){const a=he.transferPointFromImageToViewPortContent(t.point,e),i=he.setPointBetweenPixels(a),s=O.getRectWithCenterAndSize(i,this.config.anchorHoverSize);if(O.isPointInside(s,e.mousePositionOnViewPortContent))return void Ii.dispatch(Q(oe.MOVE))}else if(this.isInProgress())return void Ii.dispatch(Q(oe.MOVE));O.isPointInside({x:0,y:0,...Ae.getSize(this.canvas)},e.mousePositionOnViewPortContent)?(he.wrapDefaultCursorStyleInCancel(e),this.canvas.style.cursor="none"):this.canvas.style.cursor="default"}}isInProgress(){return te.viewPortActionsDisabled}getLabelPointUnderMouse(e,t){const a=re.getActiveImageData().labelPoints;for(let i=0;i<a.length;i++){const s=he.transferPointFromImageToViewPortContent(a[i].point,t),n=O.getRectWithCenterAndSize(s,this.config.anchorHoverSize);if(O.isPointInside(n,e))return a[i]}return null}}class ve extends de{constructor(e){super(e),this.config=new ne,this.activePath=[],this.resizeAnchorIndex=null,this.suggestedAnchorPositionOnCanvas=null,this.suggestedAnchorIndexInPolygon=null,this.labelType=h.POLYGON}update(e){if(e.event)switch(ce.getEventType(e.event)){case le.MOUSE_MOVE:this.mouseMoveHandler(e);break;case le.MOUSE_UP:this.mouseUpHandler(e);break;case le.MOUSE_DOWN:this.mouseDownHandler(e)}}mouseDownHandler(e){if(he.isMouseOverCanvas(e))if(this.isCreationInProgress()){he.isMouseOverAnchor(e.mousePositionOnViewPortContent,this.activePath[0],this.config.anchorSize)?this.addLabelAndFinishCreation(e):this.updateActivelyCreatedLabel(e)}else{const t=this.getPolygonUnderMouse(e);if(t){const a=t.vertices.reduce(((t,a,i)=>{if(null===t){const t=he.transferPointFromImageToViewPortContent(a,e);if(this.isMouseOverAnchor(e.mousePositionOnViewPortContent,t))return i}return t}),null);if(null!==a)this.startExistingLabelResize(e,t.id,a);else{Ii.dispatch(S(t.id));this.isMouseOverAnchor(e.mousePositionOnViewPortContent,this.suggestedAnchorPositionOnCanvas)&&this.addSuggestedAnchorToPolygonLabel(e)}}else this.updateActivelyCreatedLabel(e)}}mouseUpHandler(e){this.isResizeInProgress()&&this.endExistingLabelResize(e)}mouseMoveHandler(e){if(e.viewPortContentImageRect&&e.mousePositionOnViewPortContent){if(he.isMouseOverImage(e)&&!this.isCreationInProgress()){const t=this.getPolygonUnderMouse(e);if(t&&!this.isResizeInProgress()){re.getHighlightedLabelId()!==t.id&&Ii.dispatch(f(t.id));const a=he.transferPolygonFromImageToViewPortContent(t.vertices,e),i=this.mapPointsToLines(a.concat(a[0]));for(let t=0;t<i.length;t++){if(he.isMouseOverLine(e.mousePositionOnViewPortContent,i[t],this.config.anchorHoverSize.width/2)){this.suggestedAnchorPositionOnCanvas=ge.getCenter(i[t]),this.suggestedAnchorIndexInPolygon=t+1;break}}}else null!==re.getHighlightedLabelId()&&(Ii.dispatch(f(null)),this.discardSuggestedPoint())}}}render(e){re.getActiveImageData()&&(this.drawExistingLabels(e),this.drawActivelyCreatedLabel(e),this.drawActivelyResizeLabel(e),this.updateCursorStyle(e),this.drawSuggestedAnchor(e))}updateCursorStyle(e){if(this.canvas&&e.mousePositionOnViewPortContent&&!ue.getImageDragModeStatus()){if(he.isMouseOverCanvas(e)){if(this.isCreationInProgress()){this.isMouseOverAnchor(e.mousePositionOnViewPortContent,this.activePath[0])&&this.activePath.length>2?Ii.dispatch(Q(oe.CLOSE)):Ii.dispatch(Q(oe.DEFAULT))}else{const t=this.getAnchorUnderMouse(e);this.isMouseOverAnchor(e.mousePositionOnViewPortContent,this.suggestedAnchorPositionOnCanvas)?Ii.dispatch(Q(oe.ADD)):this.isResizeInProgress()||t?Ii.dispatch(Q(oe.MOVE)):he.wrapDefaultCursorStyleInCancel(e)}this.canvas.style.cursor="none"}else this.canvas.style.cursor="default"}}drawActivelyCreatedLabel(e){const t=this.activePath.map((e=>he.setPointBetweenPixels(e))),a=t.concat(e.mousePositionOnViewPortContent),i=this.mapPointsToLines(a);ie.drawPolygonWithFill(this.canvas,a,ie.hexToRGB(this.config.lineActiveColor,.2)),i.forEach((e=>{ie.drawLine(this.canvas,e.start,e.end,this.config.lineActiveColor,this.config.lineThickness)})),t.forEach((e=>{ie.drawCircleWithFill(this.canvas,e,g.RESIZE_HANDLE_DIMENSION_PX/2,this.config.activeAnchorColor)}))}drawActivelyResizeLabel(e){const t=re.getActivePolygonLabel();if(t&&this.isResizeInProgress()){const a=O.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),i=t.vertices.map(((t,i)=>i===this.resizeAnchorIndex?a:he.transferPointFromImageToViewPortContent(t,e)));this.drawPolygon(i,!0)}}drawExistingLabels(e){const t=re.getActiveLabelId(),a=re.getHighlightedLabelId();re.getActiveImageData().labelPolygons.forEach((i=>{const s=i.id===t||i.id===a,n=he.transferPolygonFromImageToViewPortContent(i.vertices,e);i.id===t&&this.isResizeInProgress()||this.drawPolygon(n,s)}))}drawPolygon(e,t){const a=t?this.config.lineActiveColor:this.config.lineInactiveColor,i=e.map((e=>he.setPointBetweenPixels(e)));t&&ie.drawPolygonWithFill(this.canvas,i,ie.hexToRGB(a,.2)),ie.drawPolygon(this.canvas,i,a,this.config.lineThickness),t&&i.forEach((e=>{ie.drawCircleWithFill(this.canvas,e,g.RESIZE_HANDLE_DIMENSION_PX/2,this.config.activeAnchorColor)}))}drawSuggestedAnchor(e){if(this.suggestedAnchorPositionOnCanvas){const t=O.getRectWithCenterAndSize(this.suggestedAnchorPositionOnCanvas,this.config.suggestedAnchorDetectionSize);O.isPointInside(t,e.mousePositionOnViewPortContent)&&ie.drawCircleWithFill(this.canvas,this.suggestedAnchorPositionOnCanvas,g.RESIZE_HANDLE_DIMENSION_PX/2,this.config.lineInactiveColor)}}updateActivelyCreatedLabel(e){if(this.isCreationInProgress()){const t=O.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect);this.activePath.push(t)}else{O.isPointInside(e.viewPortContentImageRect,e.mousePositionOnViewPortContent)&&(De.setViewPortActionsDisabledStatus(!0),this.activePath.push(e.mousePositionOnViewPortContent),Ii.dispatch(S(null)))}}cancelLabelCreation(){this.activePath=[],De.setViewPortActionsDisabledStatus(!1)}finishLabelCreation(){this.activePath=[],De.setViewPortActionsDisabledStatus(!1)}addLabelAndFinishCreation(e){if(this.isCreationInProgress()&&this.activePath.length>2){const t=he.transferPolygonFromViewPortContentToImage(this.activePath,e);this.addPolygonLabel(t),this.finishLabelCreation()}}addPolygonLabel(e){const t=re.getActiveLabelNameId(),a=re.getActiveImageData(),i=Oe.createLabelPolygon(t,e);a.labelPolygons.push(i),Ii.dispatch(D(a.id,a)),Ii.dispatch(M(!0)),Ii.dispatch(S(i.id))}startExistingLabelResize(e,t,a){Ii.dispatch(S(t)),this.resizeAnchorIndex=a,De.setViewPortActionsDisabledStatus(!0)}endExistingLabelResize(e){this.applyResizeToPolygonLabel(e),this.resizeAnchorIndex=null,De.setViewPortActionsDisabledStatus(!1)}applyResizeToPolygonLabel(e){const t=re.getActiveImageData(),a=re.getActivePolygonLabel();t.labelPolygons=t.labelPolygons.map((t=>t.id!==a.id?t:{...t,vertices:t.vertices.map(((t,a)=>{if(a!==this.resizeAnchorIndex)return t;{const t=O.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect);return he.transferPointFromViewPortContentToImage(t,e)}}))})),Ii.dispatch(D(t.id,t)),Ii.dispatch(S(a.id))}discardSuggestedPoint(){this.suggestedAnchorIndexInPolygon=null,this.suggestedAnchorPositionOnCanvas=null}addSuggestedAnchorToPolygonLabel(e){const t=re.getActiveImageData(),a=re.getActivePolygonLabel(),i=he.transferPointFromViewPortContentToImage(this.suggestedAnchorPositionOnCanvas,e),s={...t,labelPolygons:t.labelPolygons.map((e=>{return e.id!==a.id?e:{...e,vertices:(t=e.vertices,s=this.suggestedAnchorIndexInPolygon,n=i,[...t.slice(0,s),n,...t.slice(s)])};var t,s,n}))};Ii.dispatch(D(s.id,s)),this.startExistingLabelResize(e,a.id,this.suggestedAnchorIndexInPolygon),this.discardSuggestedPoint()}isInProgress(){return this.isCreationInProgress()||this.isResizeInProgress()}isCreationInProgress(){return null!==this.activePath&&0!==this.activePath.length}isResizeInProgress(){return null!==this.resizeAnchorIndex}isMouseOverAnchor(e,t){return e&&t?O.isPointInside(O.getRectWithCenterAndSize(t,this.config.anchorSize),e):null}mapPointsToLines(e){const t=[];for(let a=0;a<e.length-1;a++)t.push({start:e[a],end:e[a+1]});return t}getPolygonUnderMouse(e){const t=re.getActiveImageData().labelPolygons;for(let a=0;a<t.length;a++){const i=he.transferPolygonFromImageToViewPortContent(t[a].vertices,e),s=this.mapPointsToLines(i.concat(i[0]));for(let n=0;n<s.length;n++){if(he.isMouseOverLine(e.mousePositionOnViewPortContent,s[n],this.config.anchorHoverSize.width/2))return t[a]}for(let n=0;n<i.length;n++)if(this.isMouseOverAnchor(e.mousePositionOnViewPortContent,i[n]))return t[a]}return null}getAnchorUnderMouse(e){const t=re.getActiveImageData().labelPolygons;for(let a=0;a<t.length;a++){const i=he.transferPolygonFromImageToViewPortContent(t[a].vertices,e);for(let t=0;t<i.length;t++)if(this.isMouseOverAnchor(e.mousePositionOnViewPortContent,i[t]))return i[t]}return null}}class je{}je.CANVAS_MIN_MARGIN_PX=20,je.MIN_ZOOM=1,je.MAX_ZOOM=4,je.ZOOM_STEP=.1,je.TRANSLATION_STEP_PX=20;class Ee{static getSize(e){return e?{width:e.width,height:e.height}:null}}class Ce{static scale(e,t){return{width:e.width*t,height:e.height*t}}}class Te{static convertDirectionToVector(e){switch(e){case l.RIGHT:return{x:1,y:0};case l.LEFT:return{x:-1,y:0};case l.TOP:return{x:0,y:1};case l.BOTTOM:return{x:0,y:-1};case l.TOP_RIGHT:return{x:1,y:1};case l.TOP_LEFT:return{x:-1,y:1};case l.BOTTOM_RIGHT:return{x:1,y:-1};case l.BOTTOM_LEFT:return{x:-1,y:-1};case l.CENTER:return{x:0,y:0};default:return null}}}class Le{static updateViewPortSize(){te.editor&&(te.viewPortSize={width:te.editor.offsetWidth,height:te.editor.offsetHeight})}static updateDefaultViewPortImageRect(){if(te.viewPortSize&&te.image){const e={x:je.CANVAS_MIN_MARGIN_PX,y:je.CANVAS_MIN_MARGIN_PX},t={x:0,y:0,...Ee.getSize(te.image)},a={x:0,y:0,...te.viewPortSize},i=O.expand(a,se.multiply(e,-1));te.defaultRenderImageRect=O.fitInsideRectWithRatio(i,O.getRatio(t))}}static calculateViewPortContentSize(){if(te.viewPortSize&&te.image){const e=te.defaultRenderImageRect,t=Ce.scale(te.defaultRenderImageRect,ue.getZoom());return{width:t.width+2*e.x,height:t.height+2*e.y}}return null}static calculateViewPortContentImageRect(){if(te.viewPortSize&&te.image){const e=te.defaultRenderImageRect,t=Le.calculateViewPortContentSize();return{...e,width:t.width-2*e.x,height:t.height-2*e.y}}return null}static resizeCanvas(e){e&&te.canvas&&(te.canvas.width=e.width,te.canvas.height=e.height)}static resizeViewPortContent(){const e=Le.calculateViewPortContentSize();e&&Le.resizeCanvas(e)}static calculateAbsoluteScrollPosition(e){const t=Le.calculateViewPortContentSize(),a=te.viewPortSize;return{x:e.x*(t.width-a.width),y:e.y*(t.height-a.height)}}static getRelativeScrollPosition(){if(te.viewPortScrollbars){const e=te.viewPortScrollbars.getValues();return{x:e.left,y:e.top}}return null}static getAbsoluteScrollPosition(){if(te.viewPortScrollbars){const e=te.viewPortScrollbars.getValues();return{x:e.scrollLeft,y:e.scrollTop}}return null}static setScrollPosition(e){te.viewPortScrollbars.scrollLeft(e.x),te.viewPortScrollbars.scrollTop(e.y)}static translateViewPortPosition(e){if(te.viewPortActionsDisabled||ue.getZoom()===je.MIN_ZOOM)return;const t=Te.convertDirectionToVector(e),a=se.multiply(t,je.TRANSLATION_STEP_PX),i=Le.getAbsoluteScrollPosition(),s=se.add(i,a);Le.setScrollPosition(s),te.mousePositionOnViewPortContent=se.add(te.mousePositionOnViewPortContent,a),De.fullRender()}static zoomIn(){if(te.viewPortActionsDisabled)return;const e=ue.getZoom(),t=Le.getRelativeScrollPosition(),a=1===e?{x:.5,y:.5}:t;Le.setZoom(e+je.ZOOM_STEP),Le.resizeViewPortContent(),Le.setScrollPosition(Le.calculateAbsoluteScrollPosition(a)),De.fullRender()}static zoomOut(){if(te.viewPortActionsDisabled)return;const e=ue.getZoom(),t=Le.getRelativeScrollPosition();Le.setZoom(e-je.ZOOM_STEP),Le.resizeViewPortContent(),Le.setScrollPosition(Le.calculateAbsoluteScrollPosition(t)),De.fullRender()}static setDefaultZoom(){const e=Le.getRelativeScrollPosition();Le.setZoom(je.MIN_ZOOM),Le.resizeViewPortContent(),Le.setScrollPosition(Le.calculateAbsoluteScrollPosition(e)),De.fullRender()}static setOneForOneZoom(){const e=ue.getZoom(),t=Le.getRelativeScrollPosition(),a=1===e?{x:.5,y:.5}:t,i=te.image.width/te.defaultRenderImageRect.width;Le.setZoom(i),Le.resizeViewPortContent(),Le.setScrollPosition(Le.calculateAbsoluteScrollPosition(a)),De.fullRender()}static setZoom(e){const t=ue.getZoom();var a;m.isValueInRange(e,je.MIN_ZOOM,je.MAX_ZOOM)&&e!==t&&Ii.dispatch((a=e,{type:L.UPDATE_ZOOM,payload:{zoom:a}}))}}let xe=function(e){return e.IMAGE_RECOGNITION="IMAGE_RECOGNITION",e.OBJECT_DETECTION="OBJECT_DETECTION",e}({});class ye extends de{constructor(e){super(e),this.config=new ne}mouseMoveHandler(e){}mouseDownHandler(e){}mouseUpHandler(e){}render(e){this.drawImage(te.image,Le.calculateViewPortContentImageRect()),this.renderCrossHair(e)}renderCrossHair(e){if(!this.shouldRenderCrossHair(e))return;const t=he.setPointBetweenPixels(e.mousePositionOnViewPortContent),a=(e,t)=>{ie.drawLine(this.canvas,e,t,this.config.crossHairLineColor,2)};a({x:t.x,y:0},{x:t.x-1,y:t.y-this.config.crossHairPadding}),a({x:t.x,y:t.y+this.config.crossHairPadding},{x:t.x-1,y:e.viewPortContentSize.height}),a({x:0,y:t.y},{x:t.x-this.config.crossHairPadding,y:t.y-1}),a({x:t.x+this.config.crossHairPadding,y:t.y},{x:e.viewPortContentSize.width,y:t.y-1})}shouldRenderCrossHair(e){const t=ue.getCrossHairVisibleStatus(),a=ue.getImageDragModeStatus(),i=ue.getProjectType(),s=ue.getActivePopupType(),n=he.isMouseOverCanvas(e),o=ue.getPreventCustomCursorStatus();return[!!this.canvas,t,!a,i!==xe.IMAGE_RECOGNITION,!s,n,!o].every(Boolean)}drawImage(e,t){if(e&&this.canvas){this.canvas.getContext("2d").drawImage(e,t.x,t.y,t.width,t.height)}}isInProgress(){return!1}}class Se{constructor(){this.startScrollPosition=void 0,this.mouseStartPosition=void 0}update(e){if(e.event)switch(ce.getEventType(e.event)){case le.MOUSE_MOVE:this.mouseMoveHandler(e);break;case le.MOUSE_UP:this.mouseUpHandler(e);break;case le.MOUSE_DOWN:this.mouseDownHandler(e)}}mouseDownHandler(e){const t=e.event;this.startScrollPosition=e.absoluteViewPortContentScrollPosition,this.mouseStartPosition={x:t.screenX,y:t.screenY},Ii.dispatch(Q(oe.GRABBING)),te.canvas.style.cursor="none"}mouseUpHandler(e){this.startScrollPosition=null,this.mouseStartPosition=null,Ii.dispatch(Q(oe.GRAB)),te.canvas.style.cursor="none"}mouseMoveHandler(e){if(this.startScrollPosition&&this.mouseStartPosition){const t=e.event,a={x:t.screenX,y:t.screenY},i=se.subtract(a,this.mouseStartPosition),s=se.subtract(this.startScrollPosition,i);Le.setScrollPosition(s),Ii.dispatch(Q(oe.GRABBING))}else Ii.dispatch(Q(oe.GRAB));te.canvas.style.cursor="none"}}let fe=function(e){return e.START="START",e.END="END",e}({});class we extends de{constructor(e){super(e),this.config=new ne,this.lineCreationStartPoint=void 0,this.lineUpdateAnchorType=void 0,this.startNewLabelCreation=e=>{this.lineCreationStartPoint=he.setPointBetweenPixels(e.mousePositionOnViewPortContent),De.setViewPortActionsDisabledStatus(!0)},this.finishNewLabelCreation=e=>{const t=O.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),a={start:this.lineCreationStartPoint,end:t},i=he.transferLineFromViewPortContentToImage(a,e),s=re.getActiveLabelNameId(),n=re.getActiveImageData(),o={id:me()(),labelId:s,line:i};n.labelLines.push(o),Ii.dispatch(D(n.id,n)),Ii.dispatch(M(!0)),Ii.dispatch(S(o.id)),this.lineCreationStartPoint=null,De.setViewPortActionsDisabledStatus(!1)},this.labelType=h.LINE}mouseDownHandler(e){const t=he.isMouseOverImage(e),a=he.isMouseOverCanvas(e),i=this.getAnchorTypeUnderMouse(e),s=this.getLineUnderMouse(e);if(a)if(i&&!this.isResizeInProgress()){const t=this.getLineUnderMouse(e);this.startExistingLabelUpdate(t.id,i)}else s?Ii.dispatch(S(s.id)):!this.isInProgress()&&t?this.startNewLabelCreation(e):this.finishNewLabelCreation(e)}mouseUpHandler(e){this.isResizeInProgress()&&this.endExistingLabelUpdate(e)}mouseMoveHandler(e){if(he.isMouseOverImage(e)){const t=this.getLineUnderMouse(e);t?re.getHighlightedLabelId()!==t.id&&Ii.dispatch(f(t.id)):null!==re.getHighlightedLabelId()&&Ii.dispatch(f(null))}}render(e){this.drawExistingLabels(e),this.drawActivelyCreatedLabel(e),this.drawActivelyResizeLabel(e),this.updateCursorStyle(e)}drawExistingLabels(e){const t=re.getActiveLabelId(),a=re.getHighlightedLabelId();re.getActiveImageData().labelLines.forEach((i=>{const s=i.id===t||i.id===a,n=he.transferLineFromImageToViewPortContent(i.line,e);i.id===t&&this.isResizeInProgress()||this.drawLine(n,s)}))}drawActivelyCreatedLabel(e){if(this.isInProgress()){const t={start:this.lineCreationStartPoint,end:e.mousePositionOnViewPortContent};ie.drawLine(this.canvas,t.start,t.end,this.config.lineActiveColor,this.config.lineThickness),ie.drawCircleWithFill(this.canvas,this.lineCreationStartPoint,g.RESIZE_HANDLE_DIMENSION_PX/2,this.config.activeAnchorColor)}}drawActivelyResizeLabel(e){const t=re.getActiveLineLabel();if(t&&this.isResizeInProgress()){const a=O.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),i=he.transferLineFromImageToViewPortContent(t.line,e),s={start:this.lineUpdateAnchorType===fe.START?a:i.start,end:this.lineUpdateAnchorType===fe.END?a:i.end};this.drawLine(s,!0)}}updateCursorStyle(e){if(this.canvas&&e.mousePositionOnViewPortContent&&!ue.getImageDragModeStatus()){if(he.isMouseOverCanvas(e)){const t=this.getAnchorTypeUnderMouse(e);!this.isInProgress()&&t||this.isResizeInProgress()?Ii.dispatch(Q(oe.MOVE)):he.wrapDefaultCursorStyleInCancel(e),this.canvas.style.cursor="none"}else this.canvas.style.cursor="default"}}drawLine(e,t){const a=t?this.config.lineActiveColor:this.config.lineInactiveColor,i={start:he.setPointBetweenPixels(e.start),end:he.setPointBetweenPixels(e.end)};ie.drawLine(this.canvas,i.start,i.end,a,this.config.lineThickness),t&&ge.getPoints(e).map((e=>ie.drawCircleWithFill(this.canvas,e,g.RESIZE_HANDLE_DIMENSION_PX/2,this.config.activeAnchorColor)))}isInProgress(){return!!this.lineCreationStartPoint}isResizeInProgress(){return!!this.lineUpdateAnchorType}isMouseOverAnchor(e,t){return e&&t?O.isPointInside(O.getRectWithCenterAndSize(t,this.config.anchorSize),e):null}cancelLabelCreation(){this.lineCreationStartPoint=null,De.setViewPortActionsDisabledStatus(!1)}startExistingLabelUpdate(e,t){Ii.dispatch(S(e)),this.lineUpdateAnchorType=t,De.setViewPortActionsDisabledStatus(!0)}endExistingLabelUpdate(e){this.applyUpdateToLineLabel(e),this.lineUpdateAnchorType=null,De.setViewPortActionsDisabledStatus(!1)}applyUpdateToLineLabel(e){const t=re.getActiveImageData(),a=re.getActiveLineLabel();t.labelLines=t.labelLines.map((t=>{if(t.id!==a.id)return t;{const a=O.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),i=he.transferPointFromViewPortContentToImage(a,e);return{...t,line:{start:this.lineUpdateAnchorType===fe.START?i:t.line.start,end:this.lineUpdateAnchorType===fe.END?i:t.line.end}}}})),Ii.dispatch(D(t.id,t)),Ii.dispatch(S(a.id))}getLineUnderMouse(e){const t=re.getActiveImageData().labelLines;for(let a=0;a<t.length;a++){const i=he.transferLineFromImageToViewPortContent(t[a].line,e);if(he.isMouseOverLine(e.mousePositionOnViewPortContent,i,this.config.anchorHoverSize.width/2))return t[a]}return null}getAnchorTypeUnderMouse(e){const t=re.getActiveImageData().labelLines;for(let a=0;a<t.length;a++){const i=he.transferLineFromImageToViewPortContent(t[a].line,e);if(this.isMouseOverAnchor(e.mousePositionOnViewPortContent,i.start))return fe.START;if(this.isMouseOverAnchor(e.mousePositionOnViewPortContent,i.end))return fe.END}return null}}class De{static mountSupportRenderingEngine(e){switch(e){case h.RECT:te.supportRenderingEngine=new Ie(te.canvas);break;case h.POINT:te.supportRenderingEngine=new Pe(te.canvas);break;case h.LINE:te.supportRenderingEngine=new we(te.canvas);break;case h.POLYGON:te.supportRenderingEngine=new ve(te.canvas);break;default:te.supportRenderingEngine=null}}static swapSupportRenderingEngine(e){De.mountSupportRenderingEngine(e)}static mountRenderEnginesAndHelpers(e){te.viewPortHelper=new Se,te.primaryRenderingEngine=new ye(te.canvas),De.mountSupportRenderingEngine(e)}static fullRender(){ie.clearCanvas(te.canvas),te.primaryRenderingEngine.render(De.getEditorData()),te.supportRenderingEngine&&te.supportRenderingEngine.render(De.getEditorData())}static setLoadingStatus(e){te.isLoading=e}static setActiveImage(e){te.image=e}static setViewPortActionsDisabledStatus(e){te.viewPortActionsDisabled=e}static getEditorData(e){return{mousePositionOnViewPortContent:te.mousePositionOnViewPortContent,viewPortContentSize:Ae.getSize(te.canvas),activeKeyCombo:ke.getActiveCombo(),event:e,zoom:ue.getZoom(),viewPortSize:te.viewPortSize,defaultRenderImageRect:te.defaultRenderImageRect,viewPortContentImageRect:Le.calculateViewPortContentImageRect(),realImageSize:Ee.getSize(te.image),absoluteViewPortContentScrollPosition:Le.getAbsoluteScrollPosition()}}static updateMousePositionIndicator(e){if(!te.image||!te.canvas)return te.mousePositionIndicator.style.display="none",void(te.cursor.style.display="none");const t=Ae.getMousePositionOnCanvasFromEvent(e,te.canvas),a=Le.getAbsoluteScrollPosition(),i=Le.calculateViewPortContentImageRect(),s=se.subtract(t,a),n=O.isPointInside(i,t);if(O.isPointInside({x:0,y:0,...te.viewPortSize},s)&&!ue.getPreventCustomCursorStatus())if(te.cursor.style.left=s.x+"px",te.cursor.style.top=s.y+"px",te.cursor.style.display="block",n&&![oe.GRAB,oe.GRABBING].includes(ue.getCustomCursorStyle())){const e=Ee.getSize(te.image).width/i.width,a=se.multiply(se.subtract(t,i),e),n="x: "+Math.round(a.x)+", y: "+Math.round(a.y);te.mousePositionIndicator.innerHTML=n,te.mousePositionIndicator.style.left=s.x+15+"px",te.mousePositionIndicator.style.top=s.y+15+"px",te.mousePositionIndicator.style.display="block"}else te.mousePositionIndicator.style.display="none";else te.cursor.style.display="none",te.mousePositionIndicator.style.display="none"}}class Ne{static getActions(){return this.actions}}Ne.actions=[];class Re{static getPreviousImage(){const e=re.getActiveImageIndex();Re.getImageByIndex(e-1)}static getNextImage(){const e=re.getActiveImageIndex();Re.getImageByIndex(e+1)}static getImageByIndex(e){if(te.viewPortActionsDisabled)return;const t=re.getImagesData().length;e<0||e>t-1||(Le.setZoom(1),Ii.dispatch(x(e)),Ii.dispatch(S(null)))}static setActiveLabelOnActiveImage(e){const t=re.getLabelNames();if(t.length<e+1)return;const a=re.getActiveImageData();Ii.dispatch(D(a.id,Re.mapNewImageData(a,e))),Ii.dispatch(y(t[1].id))}static mapNewImageData(e,t){const a=re.getActiveLabelType(),i=re.getLabelNames();let s={...e};switch(a){case h.POINT:const a=re.getActivePointLabel();s.labelPoints=e.labelPoints.map((e=>e.id===a.id?{...e,labelId:i[t].id,status:pe.ACCEPTED}:e)),Ii.dispatch(S(a.id));break;case h.LINE:const n=re.getActiveLineLabel();s.labelLines=e.labelLines.map((e=>e.id===n.id?{...e,labelId:i[t].id,status:pe.ACCEPTED}:e)),Ii.dispatch(S(n.id));break;case h.RECT:const o=re.getActiveRectLabel();s.labelRects=e.labelRects.map((e=>e.id===o.id?{...e,labelId:i[t].id,status:pe.ACCEPTED}:e)),Ii.dispatch(S(o.id));break;case h.POLYGON:const r=re.getActivePolygonLabel();s.labelPolygons=e.labelPolygons.map((e=>e.id===r.id?{...e,labelId:i[t].id,status:pe.ACCEPTED}:e)),Ii.dispatch(S(r.id));break;case h.IMAGE_RECOGNITION:const l=i[t].id;e.labelNameIds.includes(l)?s.labelNameIds=Object(C.remove)(e.labelNameIds,(e=>e!==l)):s.labelNameIds=e.labelNameIds.concat(l)}return s}}var _e=a(253),Me=a.n(_e);class Be{static getMobileDeviceData(e){const t=new Me.a(e);return{manufacturer:t.mobile(),browser:t.userAgent(),os:t.os()}}static isMac(e){return!!e.toLowerCase().match("mac")}static isSafari(e){return!!e.toLowerCase().match("safari")}static isFirefox(e){return!!e.toLowerCase().match("firefox")}}class Ve{static deleteActiveLabel(){const e=re.getActiveImageData(),t=re.getActiveLabelId();Ve.deleteImageLabelById(e.id,t)}static deleteImageLabelById(e,t){switch(re.getActiveLabelType()){case h.POINT:Ve.deletePointLabelById(e,t);break;case h.RECT:Ve.deleteRectLabelById(e,t);break;case h.POLYGON:Ve.deletePolygonLabelById(e,t)}}static deleteRectLabelById(e,t){const a=re.getImageDataById(e),i={...a,labelRects:Object(C.filter)(a.labelRects,(e=>e.id!==t))};Ii.dispatch(D(a.id,i))}static deletePointLabelById(e,t){const a=re.getImageDataById(e),i={...a,labelPoints:Object(C.filter)(a.labelPoints,(e=>e.id!==t))};Ii.dispatch(D(a.id,i))}static deleteLineLabelById(e,t){const a=re.getImageDataById(e),i={...a,labelLines:Object(C.filter)(a.labelLines,(e=>e.id!==t))};Ii.dispatch(D(a.id,i))}static deletePolygonLabelById(e,t){const a=re.getImageDataById(e),i={...a,labelPolygons:Object(C.filter)(a.labelPolygons,(e=>e.id!==t))};Ii.dispatch(D(a.id,i))}static removeLabelNames(e){const t=re.getImagesData().map((t=>Ve.removeLabelNamesFromImageData(t,e)));Ii.dispatch(R(t))}static removeLabelNamesFromImageData(e,t){return{...e,labelRects:e.labelRects.map((e=>t.includes(e.id)?{...e,id:null}:e)),labelPoints:e.labelPoints.map((e=>t.includes(e.id)?{...e,id:null}:e)),labelPolygons:e.labelPolygons.map((e=>t.includes(e.id)?{...e,id:null}:e)),labelNameIds:e.labelNameIds.filter((e=>!t.includes(e)))}}static labelExistsInLabelNames(e){return re.getLabelNames().map((e=>e.name)).includes(e)}}class Ue extends Ne{}Ue.actions=[{keyCombo:["Enter"],action:e=>{if(te.supportRenderingEngine&&te.supportRenderingEngine.labelType===h.POLYGON){const e=De.getEditorData();te.supportRenderingEngine.addLabelAndFinishCreation(e)}De.fullRender()}},{keyCombo:["Escape"],action:e=>{if(te.supportRenderingEngine)switch(te.supportRenderingEngine.labelType){case h.POLYGON:case h.LINE:te.supportRenderingEngine.cancelLabelCreation()}De.fullRender()}},{keyCombo:Be.isMac(window.navigator.userAgent)?["Alt","ArrowLeft"]:["Control","ArrowLeft"],action:e=>{Re.getPreviousImage()}},{keyCombo:Be.isMac(window.navigator.userAgent)?["Alt","ArrowRight"]:["Control","ArrowRight"],action:e=>{Re.getNextImage()}},{keyCombo:Be.isMac(window.navigator.userAgent)?["Alt","+"]:["Control","+"],action:e=>{Le.zoomIn()}},{keyCombo:Be.isMac(window.navigator.userAgent)?["Alt","-"]:["Control","-"],action:e=>{Le.zoomOut()}},{keyCombo:["ArrowRight"],action:e=>{e.preventDefault(),Le.translateViewPortPosition(l.RIGHT)}},{keyCombo:["ArrowLeft"],action:e=>{e.preventDefault(),Le.translateViewPortPosition(l.LEFT)}},{keyCombo:["ArrowUp"],action:e=>{e.preventDefault(),Le.translateViewPortPosition(l.BOTTOM)}},{keyCombo:["ArrowDown"],action:e=>{e.preventDefault(),Le.translateViewPortPosition(l.TOP)}},{keyCombo:Be.isMac(window.navigator.userAgent)?["Backspace"]:["Delete"],action:e=>{Ve.deleteActiveLabel()}},{keyCombo:Be.isMac(window.navigator.userAgent)?["Alt","0"]:["Control","0"],action:e=>{Re.setActiveLabelOnActiveImage(0),De.fullRender()}},{keyCombo:Be.isMac(window.navigator.userAgent)?["Alt","1"]:["Control","1"],action:e=>{Re.setActiveLabelOnActiveImage(1),De.fullRender()}},{keyCombo:Be.isMac(window.navigator.userAgent)?["Alt","2"]:["Control","2"],action:e=>{Re.setActiveLabelOnActiveImage(2),De.fullRender()}},{keyCombo:Be.isMac(window.navigator.userAgent)?["Alt","3"]:["Control","3"],action:e=>{Re.setActiveLabelOnActiveImage(3),De.fullRender()}},{keyCombo:Be.isMac(window.navigator.userAgent)?["Alt","4"]:["Control","4"],action:e=>{Re.setActiveLabelOnActiveImage(4),De.fullRender()}},{keyCombo:Be.isMac(window.navigator.userAgent)?["Alt","5"]:["Control","5"],action:e=>{Re.setActiveLabelOnActiveImage(5),De.fullRender()}},{keyCombo:Be.isMac(window.navigator.userAgent)?["Alt","6"]:["Control","6"],action:e=>{Re.setActiveLabelOnActiveImage(6),De.fullRender()}},{keyCombo:Be.isMac(window.navigator.userAgent)?["Alt","7"]:["Control","7"],action:e=>{Re.setActiveLabelOnActiveImage(7),De.fullRender()}},{keyCombo:Be.isMac(window.navigator.userAgent)?["Alt","8"]:["Control","8"],action:e=>{Re.setActiveLabelOnActiveImage(8),De.fullRender()}},{keyCombo:Be.isMac(window.navigator.userAgent)?["Alt","9"]:["Control","9"],action:e=>{Re.setActiveLabelOnActiveImage(9),De.fullRender()}}];class Fe{static close(){Ii.dispatch(q(null)),ke.restoreCtx()}static loading(){Ii.dispatch(q(c.LOADER)),ke.restoreCtx()}}class ze extends Ne{}ze.actions=[{keyCombo:["Escape"],action:e=>{const t=ue.getActivePopupType();g.CLOSEABLE_POPUPS.includes(t)&&Fe.close()}}];class ke{static getActiveCombo(){return ke.activeCombo}static init(){window.addEventListener(le.KEY_DOWN,ke.onDown),window.addEventListener(le.KEY_UP,ke.onUp),window.addEventListener(le.FOCUS,ke.onFocus)}static switchCtx(e){const t=ue.getActiveContext();t!==e&&(ke.contextHistory.push(t),ke.updateCtx(e))}static updateCtx(e){var t;switch(Ii.dispatch((t=e,{type:L.UPDATE_CONTEXT,payload:{activeContext:t}})),e){case K.EDITOR:ke.actions=Ue.getActions();break;case K.POPUP:ke.actions=ze.getActions();break;default:ke.actions=[]}}static restoreCtx(){ke.updateCtx(ke.contextHistory.pop())}static onDown(e){const t=ke.getKeyCodeFromEvent(e);ke.isInCombo(t)||ke.addToCombo(t),ke.execute(e)}static onUp(e){const t=ke.getKeyCodeFromEvent(e);ke.removeFromCombo(t)}static onFocus(){ke.activeCombo=[]}static execute(e){for(let t=0;t<ke.actions.length;t++){const a=ke.actions[t];ke.matchCombo(ke.activeCombo,a.keyCombo)&&a.action(e)}}static isInCombo(e){return ke.activeCombo.indexOf(e)>=0}static addToCombo(e){ke.activeCombo.push(e)}static removeFromCombo(e){const t=ke.activeCombo.indexOf(e);t>=0&&ke.activeCombo.splice(t,1)}static getKeyCodeFromEvent(e){return e.key}static matchCombo(e,t){return Object(C.isEmpty)(Object(C.xor)(e,t))}}ke.activeCombo=[],ke.actions=[],ke.contextHistory=[];class Ge extends s.a.Component{constructor(e){super(e),this.imagesListRef=void 0,this.updateListSize=()=>{if(!this.imagesListRef)return;const e=this.imagesListRef.getBoundingClientRect();this.setState({size:{width:e.width,height:e.height}})},this.isImageChecked=e=>{const t=this.props.imagesData[e];switch(this.props.activeLabelType){case h.LINE:return t.labelLines.length>0;case h.IMAGE_RECOGNITION:return t.labelNameIds.length>0;case h.POINT:return t.labelPoints.filter((e=>e.status===pe.ACCEPTED)).length>0;case h.POLYGON:return t.labelPolygons.length>0;case h.RECT:return t.labelRects.filter((e=>e.status===pe.ACCEPTED)).length>0}},this.onClickHandler=e=>{Re.getImageByIndex(e)},this.renderImagePreview=(e,t,a,i)=>Object(I.jsx)(J,{style:i,size:{width:150,height:150},isScrolling:t,isChecked:this.isImageChecked(e),imageData:this.props.imagesData[e],onClick:()=>this.onClickHandler(e),isSelected:this.props.activeImageIndex===e},e),this.state={size:null}}componentDidMount(){this.updateListSize(),window.addEventListener(le.RESIZE,this.updateListSize)}componentWillUnmount(){window.removeEventListener(le.RESIZE,this.updateListSize)}render(){const{size:e}=this.state;return Object(I.jsx)("div",{className:"ImagesList",ref:e=>this.imagesListRef=e,onClick:()=>ke.switchCtx(K.LEFT_NAVBAR),children:!!e&&Object(I.jsx)(A,{size:e,childSize:{width:150,height:150},childCount:this.props.imagesData.length,childRender:this.renderImagePreview,overScanHeight:200})})}}var He=Object(r.b)((e=>({activeImageIndex:e.labels.activeImageIndex,imagesData:e.labels.imagesData,activeLabelType:e.labels.activeLabelType})),{})(Ge);a(336);const We=[{labelType:h.IMAGE_RECOGNITION,headerText:"Image recognition",imageSrc:"ico/object.png",imageAlt:"object",projectType:xe.IMAGE_RECOGNITION},{labelType:h.RECT,headerText:"Rect",imageSrc:"ico/rectangle.png",imageAlt:"rectangle",projectType:xe.OBJECT_DETECTION},{labelType:h.POINT,headerText:"Point",imageSrc:"ico/point.png",imageAlt:"point",projectType:xe.OBJECT_DETECTION},{labelType:h.LINE,headerText:"Line",imageSrc:"ico/line.png",imageAlt:"line",projectType:xe.OBJECT_DETECTION},{labelType:h.POLYGON,headerText:"Polygon",imageSrc:"ico/polygon.png",imageAlt:"polygon",projectType:xe.OBJECT_DETECTION}];a(337),a(338),a(339);const Ye=i.forwardRef(((e,t)=>{const{buttonSize:a,padding:i,image:s,imageAlt:n,href:o,onClick:r,style:l,isActive:c,isDisabled:d,externalClassName:g}=e,h=i||10,u={...l,width:a.width,height:a.height},p={maxWidth:a.width-h,maxHeight:a.height-h};return Object(I.jsxs)("div",{className:v()("ImageButton",g,{active:c,disabled:d}),style:u,onClick:e=>{e.stopPropagation(),r&&r()},ref:t,children:[!!o&&Object(I.jsx)("a",{href:o,style:p,target:"_blank",rel:"noopener noreferrer",children:Object(I.jsx)("img",{draggable:!1,alt:n,src:s,style:p})}),!o&&Object(I.jsx)("img",{draggable:!1,alt:n,src:s,style:p})]})}));class Ze extends s.a.Component{constructor(e){super(e),this.dropdownOptionHeight=30,this.dropdownOptionCount=6,this.dropdownMargin=4,this.dropdownLabel=void 0,this.dropdown=void 0,this.openDropdown=()=>{0===re.getLabelNames().length?this.props.updateActivePopupType(c.UPDATE_LABEL):(this.setState({isOpen:!0}),window.addEventListener(le.MOUSE_DOWN,this.closeDropdown))},this.closeDropdown=e=>{const t={x:e.clientX,y:e.clientY},a=this.dropdown.getBoundingClientRect(),i={x:a.left,y:a.top,width:a.width,height:a.height};O.isPointInside(i,t)||(this.setState({isOpen:!1}),window.removeEventListener(le.MOUSE_DOWN,this.closeDropdown))},this.getDropdownStyle=()=>{const e=this.dropdownLabel.getBoundingClientRect(),t=Math.min(this.props.options.length,this.dropdownOptionCount)*this.dropdownOptionHeight,a={width:e.width,height:t,left:e.left};return 2*window.innerHeight/3<e.top?Object.assign(a,{top:e.top-this.dropdownMargin-t}):Object.assign(a,{top:e.bottom+this.dropdownMargin})},this.getDropdownOptions=()=>{const e=(e,t)=>{this.setState({isOpen:!1}),window.removeEventListener(le.MOUSE_DOWN,this.closeDropdown),this.props.onSelectLabel(this.props.id,e),this.props.updateHighlightedLabelId(null),this.props.updateActiveLabelId(this.props.id),t.stopPropagation()};return this.props.options.map((t=>Object(I.jsx)("div",{className:"DropdownOption",style:{height:this.dropdownOptionHeight},onClick:a=>e(t.id,a),children:t.name},t.id)))},this.mouseEnterHandler=()=>{this.props.updateHighlightedLabelId(this.props.id)},this.mouseLeaveHandler=()=>{this.props.updateHighlightedLabelId(null)},this.onClickHandler=()=>{this.props.updateActiveLabelId(this.props.id)},this.state={animate:!1,isOpen:!1}}componentDidMount(){requestAnimationFrame((()=>{this.setState({animate:!0})}))}getClassName(){return v()("LabelInputField",{loaded:this.state.animate,active:this.props.isActive,highlighted:this.props.isHighlighted})}render(){const{size:e,id:t,value:a,onDelete:i}=this.props;return Object(I.jsx)("div",{className:this.getClassName(),style:{width:e.width,height:e.height},onMouseEnter:this.mouseEnterHandler,onMouseLeave:this.mouseLeaveHandler,onClick:this.onClickHandler,children:Object(I.jsxs)("div",{className:"LabelInputFieldWrapper",style:{width:e.width,height:e.height},children:[Object(I.jsx)("div",{className:"Marker"}),Object(I.jsxs)("div",{className:"Content",children:[Object(I.jsxs)("div",{className:"ContentWrapper",children:[Object(I.jsx)("div",{className:"DropdownLabel",ref:e=>this.dropdownLabel=e,onClick:this.openDropdown,children:a?a.name:"Select label"}),this.state.isOpen&&Object(I.jsx)("div",{className:"Dropdown",style:this.getDropdownStyle(),ref:e=>this.dropdown=e,children:Object(I.jsx)(p.a,{renderTrackHorizontal:e=>Object(I.jsx)("div",{...e,className:"track-horizontal"}),children:Object(I.jsx)("div",{children:this.getDropdownOptions()})})})]}),Object(I.jsx)("div",{className:"ContentWrapper",children:Object(I.jsx)(Ye,{externalClassName:"trash",image:"ico/trash.png",imageAlt:"remove_rect",buttonSize:{width:30,height:30},onClick:()=>i(t)})})]})]})},t)}}const Xe={updateHighlightedLabelId:f,updateActiveLabelId:S,updateActivePopupType:q};var Je=Object(r.b)((e=>({})),Xe)(Ze);a(340);var Ke=Object(r.b)((e=>({firstLabelCreatedFlag:e.labels.firstLabelCreatedFlag})),{})((e=>{let{firstLabelCreatedFlag:t,labelBefore:a,labelAfter:i}=e;const s=Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("img",{draggable:!1,alt:"lets_start",src:"ico/rocket.png"}),Object(I.jsx)("p",{className:"extraBold",children:a})]}),n=Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("img",{draggable:!1,alt:"no_labels",src:"ico/box-opened.png"}),Object(I.jsx)("p",{className:"extraBold",children:i})]});return Object(I.jsx)("div",{className:"EmptyLabelList",children:t?n:s})}));const qe={updateImageDataById:D,updateActiveLabelNameId:y,updateActiveLabelId:S};var Qe=Object(r.b)((e=>({activeLabelId:e.labels.activeLabelId,highlightedLabelId:e.labels.highlightedLabelId,labelNames:e.labels.labels})),qe)((e=>{let{size:t,imageData:a,updateImageDataById:i,labelNames:s,updateActiveLabelNameId:n,activeLabelId:o,highlightedLabelId:r,updateActiveLabelId:l}=e;const c={width:t.width,height:t.height},d={width:t.width,height:40*a.labelRects.length},g=e=>{Ve.deleteRectLabelById(a.id,e)},h=(e,t)=>{const s={...a,labelRects:a.labelRects.map((a=>a.id===e?{...a,labelId:t,status:pe.ACCEPTED}:a))};i(a.id,s),n(t)};return Object(I.jsx)("div",{className:"RectLabelsList",style:c,onClickCapture:()=>{l(null)},children:0===a.labelRects.filter((e=>e.status===pe.ACCEPTED)).length?Object(I.jsx)(Ke,{labelBefore:"draw your first bounding box",labelAfter:"no labels created for this image yet"}):Object(I.jsx)(p.a,{children:Object(I.jsx)("div",{className:"RectLabelsListContent",style:d,children:a.labelRects.filter((e=>e.status===pe.ACCEPTED)).map((e=>Object(I.jsx)(Je,{size:{width:t.width,height:40},isActive:e.id===o,isHighlighted:e.id===r,id:e.id,onDelete:g,value:null!==e.labelId?Object(C.findLast)(s,{id:e.labelId}):null,options:s,onSelectLabel:h},e.id)))})})})}));a(341);const $e={updateImageDataById:D,updateActiveLabelNameId:y,updateActiveLabelId:S};var et=Object(r.b)((e=>({activeLabelId:e.labels.activeLabelId,highlightedLabelId:e.labels.highlightedLabelId,labelNames:e.labels.labels})),$e)((e=>{let{size:t,imageData:a,updateImageDataById:i,labelNames:s,updateActiveLabelNameId:n,activeLabelId:o,highlightedLabelId:r,updateActiveLabelId:l}=e;const c={width:t.width,height:t.height},d={width:t.width,height:40*a.labelPoints.length},g=e=>{Ve.deletePointLabelById(a.id,e)},h=(e,t)=>{const s={...a,labelPoints:a.labelPoints.map((a=>a.id===e?{...a,labelId:t}:a))};i(a.id,s),n(t)};return Object(I.jsx)("div",{className:"PointLabelsList",style:c,onClickCapture:()=>{l(null)},children:0===a.labelPoints.filter((e=>e.status===pe.ACCEPTED)).length?Object(I.jsx)(Ke,{labelBefore:"mark your first point",labelAfter:"no labels created for this image yet"}):Object(I.jsx)(p.a,{children:Object(I.jsx)("div",{className:"PointLabelsListContent",style:d,children:a.labelPoints.filter((e=>e.status===pe.ACCEPTED)).map((e=>Object(I.jsx)(Je,{size:{width:t.width,height:40},isActive:e.id===o,isHighlighted:e.id===r,id:e.id,onDelete:g,value:null!==e.labelId?Object(C.findLast)(s,{id:e.labelId}):null,options:s,onSelectLabel:h},e.id)))})})})}));a(342);const tt={updateImageDataById:D,updateActiveLabelNameId:y,updateActiveLabelId:S};var at=Object(r.b)((e=>({activeLabelId:e.labels.activeLabelId,highlightedLabelId:e.labels.highlightedLabelId,labelNames:e.labels.labels})),tt)((e=>{let{size:t,imageData:a,updateImageDataById:i,labelNames:s,updateActiveLabelNameId:n,activeLabelId:o,highlightedLabelId:r,updateActiveLabelId:l}=e;const c={width:t.width,height:t.height},d={width:t.width,height:40*a.labelPolygons.length},g=e=>{Ve.deletePolygonLabelById(a.id,e)},h=(e,t)=>{const s={...a,labelPolygons:a.labelPolygons.map((a=>a.id===e?{...a,labelId:t}:a))};i(a.id,s),n(t)};return Object(I.jsx)("div",{className:"PolygonLabelsList",style:c,onClickCapture:()=>{l(null)},children:0===a.labelPolygons.length?Object(I.jsx)(Ke,{labelBefore:"draw your first polygon",labelAfter:"no labels created for this image yet"}):Object(I.jsx)(p.a,{children:Object(I.jsx)("div",{className:"PolygonLabelsListContent",style:d,children:a.labelPolygons.map((e=>Object(I.jsx)(Je,{size:{width:t.width,height:40},isActive:e.id===o,isHighlighted:e.id===r,id:e.id,onDelete:g,value:null!==e.labelId?Object(C.findLast)(s,{id:e.labelId}):null,options:s,onSelectLabel:h},e.id)))})})})}));a(343);const it={updateImageDataById:D,updateActiveLabelNameId:y,updateActiveLabelId:S};var st=Object(r.b)((e=>({activeLabelId:e.labels.activeLabelId,highlightedLabelId:e.labels.highlightedLabelId,labelNames:e.labels.labels})),it)((e=>{let{size:t,imageData:a,updateImageDataById:i,labelNames:s,updateActiveLabelNameId:n,activeLabelId:o,highlightedLabelId:r,updateActiveLabelId:l}=e;const c={width:t.width,height:t.height},d={width:t.width,height:40*a.labelLines.length},g=e=>{Ve.deleteLineLabelById(a.id,e)},h=(e,t)=>{const s={...a,labelLines:a.labelLines.map((a=>a.id===e?{...a,labelId:t}:a))};i(a.id,s),n(t)};return Object(I.jsx)("div",{className:"LineLabelsList",style:c,onClickCapture:()=>{l(null)},children:0===a.labelLines.length?Object(I.jsx)(Ke,{labelBefore:"draw your first line",labelAfter:"no labels created for this image yet"}):Object(I.jsx)(p.a,{children:Object(I.jsx)("div",{className:"LineLabelsListContent",style:d,children:a.labelLines.map((e=>Object(I.jsx)(Je,{size:{width:t.width,height:40},isActive:e.id===o,isHighlighted:e.id===r,id:e.id,onDelete:g,value:null!==e.labelId?Object(C.findLast)(s,{id:e.labelId}):null,options:s,onSelectLabel:h},e.id)))})})})}));a(344);const nt={updateImageDataById:D,updateActivePopupType:q};var ot=Object(r.b)((e=>({labelNames:e.labels.labels})),nt)((e=>{let{size:t,imageData:a,updateImageDataById:i,labelNames:s,updateActivePopupType:n}=e;const o={width:t.width,height:t.height},r={width:t.width,height:40*a.labelPolygons.length},l=()=>{n(c.UPDATE_LABEL)};return Object(I.jsx)("div",{className:"TagLabelsList",style:o,children:0===s.length?Object(I.jsxs)("div",{className:"EmptyLabelList",onClick:l,children:[Object(I.jsx)("img",{draggable:!1,alt:"upload",src:"ico/type-writer.png"}),Object(I.jsx)("p",{className:"extraBold",children:"Your label list is empty"})]},"empty-label-list"):Object(I.jsx)(p.a,{children:Object(I.jsx)("div",{className:"TagLabelsListContent",style:r,children:[...s.map((e=>{return Object(I.jsx)("div",{className:(t=e.id,v()("TagItem",{active:a.labelNameIds.includes(t)})),onClickCapture:()=>(e=>{a.labelNameIds.includes(e)?i(a.id,{...a,labelNameIds:Object(C.remove)(a.labelNameIds,(t=>t!==e))}):i(a.id,{...a,labelNameIds:a.labelNameIds.concat(e)})})(e.id),children:e.name},e.id);var t})),Object(I.jsx)(Ye,{image:"ico/plus.png",imageAlt:"plus",buttonSize:{width:32,height:32},onClick:l})]},"tag-labels-list-content")})},"tag-labels-list")}));class rt extends s.a.Component{constructor(e){super(e),this.labelsToolkitRef=void 0,this.tabs=void 0,this.updateToolkitSize=()=>{if(!this.labelsToolkitRef)return;const e=this.labelsToolkitRef.getBoundingClientRect();this.setState({size:{width:e.width,height:e.height}})},this.headerClickHandler=e=>{this.props.updateActiveLabelType(e),this.props.updateActiveLabelId(null)},this.renderChildren=()=>{const{size:e}=this.state,{activeImageIndex:t,imagesData:a,activeLabelType:i}=this.props;return this.tabs.reduce(((s,n,o)=>{const r=n===i,l=Object(C.find)(We,{labelType:n}),c=e.height-this.tabs.length*g.TOOLKIT_TAB_HEIGHT_PX,d=e=>v()(e,{active:r}),u=Object(I.jsxs)("div",{className:d("Header"),onClick:()=>this.headerClickHandler(n),style:{height:g.TOOLKIT_TAB_HEIGHT_PX},children:[Object(I.jsx)("div",{className:"Marker"}),Object(I.jsxs)("div",{className:"HeaderGroupWrapper",children:[Object(I.jsx)("img",{draggable:!1,className:"Ico",src:l.imageSrc,alt:l.imageAlt}),l.headerText]}),Object(I.jsx)("div",{className:"HeaderGroupWrapper",children:Object(I.jsx)("img",{draggable:!1,className:"Arrow",src:"ico/down.png",alt:"down_arrow"})})]},"Header_"+o),p=Object(I.jsxs)("div",{className:d("Content"),style:{height:r?c:0},children:[n===h.RECT&&Object(I.jsx)(Qe,{size:{width:e.width-20,height:c-20},imageData:a[t]}),n===h.POINT&&Object(I.jsx)(et,{size:{width:e.width-20,height:c-20},imageData:a[t]}),n===h.LINE&&Object(I.jsx)(st,{size:{width:e.width-20,height:c-20},imageData:a[t]}),n===h.POLYGON&&Object(I.jsx)(at,{size:{width:e.width-20,height:c-20},imageData:a[t]}),n===h.IMAGE_RECOGNITION&&Object(I.jsx)(ot,{size:{width:e.width-20,height:c-20},imageData:a[t]})]},"Content_"+o);return s.push([u,p]),s}),[])},this.state={size:null},this.tabs=e.projectType===xe.IMAGE_RECOGNITION?[h.IMAGE_RECOGNITION]:[h.RECT,h.POINT,h.LINE,h.POLYGON];const t=e.activeLabelType?e.activeLabelType:this.tabs[0];e.updateActiveLabelType(t)}componentDidMount(){this.updateToolkitSize(),window.addEventListener(le.RESIZE,this.updateToolkitSize)}componentWillUnmount(){window.removeEventListener(le.RESIZE,this.updateToolkitSize)}render(){return Object(I.jsx)("div",{className:"LabelsToolkit",ref:e=>this.labelsToolkitRef=e,onClick:()=>ke.switchCtx(K.RIGHT_NAVBAR),children:this.state.size&&this.renderChildren()})}}const lt={updateImageDataById:D,updateActiveLabelType:w,updateActiveLabelId:S};var ct=Object(r.b)((e=>({activeImageIndex:e.labels.activeImageIndex,activeLabelType:e.labels.activeLabelType,imagesData:e.labels.imagesData,projectType:e.general.projectData.type})),lt)(rt);a(345);const dt=e=>{const{direction:t,isOpen:a,isWithContext:i,renderContent:s,renderCompanion:n}=e;return Object(I.jsxs)("div",{className:v()("SideNavigationBar",{left:t===l.LEFT,right:t===l.RIGHT,"with-context":i,closed:!a}),children:[Object(I.jsx)("div",{className:"CompanionBar",children:n&&n()}),a&&Object(I.jsx)("div",{className:"NavigationBarContentWrapper",children:s&&s()})]})};a(346);const gt=e=>{const{key:t,label:a,onClick:i,style:s,isActive:n,isDisabled:o,image:r,imageAlt:l}=e;return Object(I.jsxs)("div",{className:v()("VerticalEditorButton",{active:n,disabled:o}),onClick:i||void 0,style:s,children:[r&&Object(I.jsx)("img",{draggable:!1,alt:l,src:r}),a]},t)};a(347),a(348);class ht{}ht.getIndicator=e=>{switch(e){case oe.ADD:return"ico/plus.png";case oe.RESIZE:return"ico/resize.png";case oe.CLOSE:return"ico/close.png";case oe.MOVE:return"ico/move.png";case oe.CANCEL:return"ico/cancel.png";case oe.GRAB:return"ico/hand-fill.png";case oe.GRABBING:return"ico/hand-fill-grab.png";default:return null}},ht.getCursorStyle=e=>v()("Cursor",{move:e===oe.MOVE,add:e===oe.ADD,resize:e===oe.RESIZE,close:e===oe.CLOSE,cancel:e===oe.CANCEL,grab:e===oe.GRAB,grabbing:e===oe.GRABBING});class ut{}ut.mobileDeviceData=void 0,ut.isMac=void 0,ut.isSafari=void 0,ut.isFirefox=void 0;a(349);const pt={updatePreventCustomCursorStatus:$,updateImageDataById:D};var bt=Object(r.b)((e=>({activeLabelId:e.labels.activeLabelId,highlightedLabelId:e.labels.highlightedLabelId})),pt)((e=>{let{position:t,updatePreventCustomCursorStatus:a,activeLabelId:s,highlightedLabelId:n,labelData:o,imageData:r,updateImageDataById:l}=e;const[c,d]=Object(i.useState)(!1),g=()=>c||o.id===s||o.id===n;return Object(I.jsx)("div",{className:v()("LabelControlPanel",{"is-active":g()}),style:{top:t.y,left:t.x},onMouseEnter:()=>{a(!0),d(!0)},onMouseLeave:()=>{a(!1),d(!1)},children:g()&&Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(Ye,{image:"ico/plus.png",imageAlt:"plus",buttonSize:{width:30,height:30},padding:15,onClick:()=>{const e={...r,labelRects:r.labelRects.map((e=>{if(e.id===o.id){const t=Object(C.findLast)(re.getLabelNames(),{name:e.suggestedLabel});return{...e,status:pe.ACCEPTED,labelId:t?t.id:e.labelId}}return e})),labelPoints:r.labelPoints.map((e=>{if(e.id===o.id){const t=Object(C.findLast)(re.getLabelNames(),{name:e.suggestedLabel});return{...e,status:pe.ACCEPTED,labelId:t?t.id:e.labelId}}return e}))};l(r.id,e),a(!1)}}),Object(I.jsx)(Ye,{image:"ico/trash.png",imageAlt:"trash",buttonSize:{width:30,height:30},padding:15,onClick:()=>{Ve.deleteImageLabelById(r.id,o.id),a(!1)}}),o.suggestedLabel&&Ve.labelExistsInLabelNames(o.suggestedLabel)?Object(I.jsx)("div",{className:"SuggestedLabel",children:o.suggestedLabel}):null]})})})),mt=a(254);function Ot(e){return{type:L.UPDATE_SUGGESTED_LABEL_LIST,payload:{labelList:e}}}class It{static loadModel(e){mt.load().then((t=>{var a;It.model=t,Ii.dispatch((a=!0,{type:L.UPDATE_OBJECT_DETECTOR_STATUS,payload:{isObjectDetectorLoaded:a}})),Ii.dispatch(w(h.RECT));re.getActiveLabelType()===h.RECT&&At.detectRectsForActiveImage(),e&&e()})).catch((e=>{throw new Error(e)}))}static predict(e,t){It.model&&It.model.detect(e).then((e=>{t&&t(e)})).catch((e=>{throw new Error(e)}))}}It.model=void 0;class At{static detectRectsForActiveImage(){const e=re.getActiveImageData();At.detectRects(e.id,T.getById(e.id))}static detectRects(e,t){!re.getImageDataById(e).isVisitedByObjectDetector&&W.isAIObjectDetectorModelLoaded()&&(Ii.dispatch(q(c.LOADER)),It.predict(t,(t=>{const a=At.extractNewSuggestedLabelNames(re.getLabelNames(),t),i=W.getRejectedSuggestedLabelList(),s=Et.excludeRejectedLabelNames(a,i);s.length>0?(Ii.dispatch(Ot(s)),Ii.dispatch(q(c.SUGGEST_LABEL_NAMES))):Ii.dispatch(q(null)),At.saveRectPredictions(e,t)})))}static saveRectPredictions(e,t){const a=re.getImageDataById(e),i=At.mapPredictionsToRectLabels(t),s={...a,labelRects:a.labelRects.concat(i),isVisitedByObjectDetector:!0};Ii.dispatch(D(a.id,s))}static mapPredictionsToRectLabels(e){return e.map((e=>({id:me()(),labelIndex:null,labelId:null,rect:{x:e.bbox[0],y:e.bbox[1],width:e.bbox[2],height:e.bbox[3]},isCreatedByAI:!0,status:pe.UNDECIDED,suggestedLabel:e.class})))}static extractNewSuggestedLabelNames(e,t){return t.reduce(((t,a)=>(t.includes(a.class)||Object(C.findLast)(e,{name:a.class})||t.push(a.class),t)),[])}static acceptAllSuggestedRectLabels(e){const t={...e,labelRects:e.labelRects.map((e=>{const t=Object(C.findLast)(re.getLabelNames(),{name:e.suggestedLabel});return{...e,status:pe.ACCEPTED,labelId:t?t.id:e.labelId}}))};Ii.dispatch(D(t.id,t))}static rejectAllSuggestedRectLabels(e){const t={...e,labelRects:e.labelRects.filter((e=>e.status===pe.ACCEPTED))};Ii.dispatch(D(t.id,t))}}var Pt=a(272);class vt{static loadModel(e){Pt.a({architecture:"ResNet50",outputStride:32,inputResolution:257,quantBytes:2}).then((t=>{var a;vt.model=t,Ii.dispatch((a=!0,{type:L.UPDATE_POSE_DETECTOR_STATUS,payload:{isPoseDetectorLoaded:a}})),Ii.dispatch(w(h.POINT));re.getActiveLabelType()===h.POINT&&jt.detectPoseForActiveImage(),e&&e()})).catch((e=>{throw new Error(e)}))}static predict(e,t){vt.model&&vt.model.estimateMultiplePoses(e).then((e=>{t&&t(e)})).catch((e=>{throw new Error(e)}))}}vt.model=void 0;class jt{static detectPoseForActiveImage(){const e=re.getActiveImageData();jt.detectPoses(e.id,T.getById(e.id))}static detectPoses(e,t){!re.getImageDataById(e).isVisitedByPoseDetector&&W.isAIPoseDetectorModelLoaded()&&(Ii.dispatch(q(c.LOADER)),vt.predict(t,(a=>{const i=jt.extractNewSuggestedLabelNames(re.getLabelNames(),a),s=W.getRejectedSuggestedLabelList(),n=Et.excludeRejectedLabelNames(i,s);n.length>0?(Ii.dispatch(Ot(n)),Ii.dispatch(q(c.SUGGEST_LABEL_NAMES))):Ii.dispatch(q(null)),jt.savePosePredictions(e,a,t)})))}static savePosePredictions(e,t,a){const i=re.getImageDataById(e),s=jt.mapPredictionsToPointLabels(t).filter((e=>m.isValueInRange(e.point.x,0,a.width))).filter((e=>m.isValueInRange(e.point.y,0,a.height))),n={...i,labelPoints:i.labelPoints.concat(s),isVisitedByPoseDetector:!0};Ii.dispatch(D(i.id,n))}static mapPredictionsToPointLabels(e){return e.map((e=>e.keypoints.map((e=>({id:me()(),labelIndex:null,labelId:null,point:{x:e.position.x,y:e.position.y},isCreatedByAI:!0,status:pe.UNDECIDED,suggestedLabel:e.part}))))).reduce(((e,t)=>e.concat(t)),[])}static extractNewSuggestedLabelNames(e,t){return t.map((e=>e.keypoints)).reduce(((e,t)=>e.concat(t)),[]).map((e=>e.part)).reduce(((t,a)=>(t.includes(a)||Object(C.findLast)(e,{name:a})||t.push(a),t)),[])}static acceptAllSuggestedPointLabels(e){const t={...e,labelPoints:e.labelPoints.map((e=>{const t=Object(C.findLast)(re.getLabelNames(),{name:e.suggestedLabel});return{...e,status:pe.ACCEPTED,labelId:t?t.id:e.labelId}}))};Ii.dispatch(D(t.id,t))}static rejectAllSuggestedPointLabels(e){const t={...e,labelPoints:e.labelPoints.filter((e=>e.status===pe.ACCEPTED))};Ii.dispatch(D(t.id,t))}}class Et{static excludeRejectedLabelNames(e,t){return e.reduce(((e,a)=>(t.includes(a)||e.push(a),e)),[])}static detect(e,t){switch(re.getActiveLabelType()){case h.RECT:At.detectRects(e,t);break;case h.POINT:jt.detectPoses(e,t)}}static rejectAllSuggestedLabels(e){switch(re.getActiveLabelType()){case h.RECT:At.rejectAllSuggestedRectLabels(e);break;case h.POINT:jt.rejectAllSuggestedPointLabels(e)}}static acceptAllSuggestedLabels(e){switch(re.getActiveLabelType()){case h.RECT:At.acceptAllSuggestedRectLabels(e);break;case h.POINT:jt.acceptAllSuggestedPointLabels(e)}}}class Ct extends s.a.Component{constructor(e){super(e),this.loadImage=async e=>{if(e.loadStatus)De.setActiveImage(T.getById(e.id)),Et.detect(e.id,T.getById(e.id)),this.updateModelAndRender();else if(!te.isLoading){De.setLoadingStatus(!0);const t=t=>this.saveLoadedImage(t,e);H.loadImage(e.fileName).then((e=>t(e))).catch((e=>this.handleLoadImageError()))}},this.saveLoadedImage=(e,t)=>{t.loadStatus=!0,this.props.updateImageDataById(t.id,t),T.storeImage(t.id,e),De.setActiveImage(e),Et.detect(t.id,e),De.setLoadingStatus(!1),this.updateModelAndRender()},this.handleLoadImageError=()=>{},this.updateModelAndRender=()=>{Le.updateViewPortSize(),Le.updateDefaultViewPortImageRect(),Le.resizeViewPortContent(),De.fullRender()},this.update=e=>{const t=De.getEditorData(e);te.mousePositionOnViewPortContent=Ae.getMousePositionOnCanvasFromEvent(e,te.canvas),te.primaryRenderingEngine.update(t),this.props.imageDragMode?te.viewPortHelper.update(t):te.supportRenderingEngine&&te.supportRenderingEngine.update(t),!this.props.activePopupType&&De.updateMousePositionIndicator(e),De.fullRender()},this.handleZoom=e=>{if(e.ctrlKey||ut.isMac&&e.metaKey){const t=Math.sign(e.deltaY);ut.isMac&&-1===t||!ut.isMac&&1===t?Le.zoomOut():(ut.isMac&&1===t||!ut.isMac&&-1===t)&&Le.zoomIn()}te.mousePositionOnViewPortContent=Ae.getMousePositionOnCanvasFromEvent(e,te.canvas)},this.getOptionsPanels=()=>{const e=De.getEditorData();return this.props.activeLabelType===h.RECT?this.props.imageData.labelRects.filter((e=>e.isCreatedByAI&&e.status!==pe.ACCEPTED)).map((t=>{const a={x:t.rect.x,y:t.rect.y},i=he.transferPointFromImageToViewPortContent(a,e);return Object(I.jsx)(bt,{position:i,labelData:t,imageData:this.props.imageData},t.id)})):this.props.activeLabelType===h.POINT?this.props.imageData.labelPoints.filter((e=>e.isCreatedByAI&&e.status!==pe.ACCEPTED)).map((t=>{const a={x:t.point.x,y:t.point.y},i=he.transferPointFromImageToViewPortContent(a,e);return Object(I.jsx)(bt,{position:i,labelData:t,imageData:this.props.imageData},t.id)})):null},this.onScrollbarsUpdate=e=>{let t={width:e.scrollWidth,height:e.scrollHeight};Object(C.isEqual)(t,this.state.viewPortSize)||this.setState({viewPortSize:t})},this.state={viewPortSize:{width:0,height:0}}}componentDidMount(){this.mountEventListeners();const{imageData:e,activeLabelType:t}=this.props;ke.switchCtx(K.EDITOR),De.mountRenderEnginesAndHelpers(t),E.addAndRun(this.loadImage(e)),Le.resizeCanvas(this.props.size)}componentWillUnmount(){this.unmountEventListeners()}componentDidUpdate(e,t,a){const{imageData:i,activeLabelType:s}=this.props;e.imageData.id!==i.id&&E.addAndRun(this.loadImage(i)),e.activeLabelType!==s&&(De.swapSupportRenderingEngine(s),Et.detect(i.id,T.getById(i.id))),this.updateModelAndRender()}mountEventListeners(){window.addEventListener(le.MOUSE_MOVE,this.update),window.addEventListener(le.MOUSE_UP,this.update),te.canvas.addEventListener(le.MOUSE_DOWN,this.update),te.canvas.addEventListener(le.MOUSE_WHEEL,this.handleZoom)}unmountEventListeners(){window.removeEventListener(le.MOUSE_MOVE,this.update),window.removeEventListener(le.MOUSE_UP,this.update),te.canvas.removeEventListener(le.MOUSE_DOWN,this.update),te.canvas.removeEventListener(le.MOUSE_WHEEL,this.handleZoom)}render(){return Object(I.jsxs)("div",{className:"Editor",ref:e=>te.editor=e,draggable:!1,children:[Object(I.jsx)(p.a,{ref:e=>te.viewPortScrollbars=e,renderTrackHorizontal:e=>Object(I.jsx)("div",{...e,className:"track-horizontal"}),renderTrackVertical:e=>Object(I.jsx)("div",{...e,className:"track-vertical"}),onUpdate:this.onScrollbarsUpdate,children:Object(I.jsxs)("div",{className:"ViewPortContent",children:[Object(I.jsx)("canvas",{className:"ImageCanvas",ref:e=>te.canvas=e,draggable:!1,onContextMenu:e=>e.preventDefault()}),this.getOptionsPanels()]})}),Object(I.jsx)("div",{className:"MousePositionIndicator",ref:e=>te.mousePositionIndicator=e,draggable:!1}),Object(I.jsx)("div",{className:ht.getCursorStyle(this.props.customCursorStyle),ref:e=>te.cursor=e,draggable:!1,children:Object(I.jsx)("img",{draggable:!1,alt:"indicator",src:ht.getIndicator(this.props.customCursorStyle)})})]})}}const Tt={updateImageDataById:D};var Lt=Object(r.b)((e=>({activeLabelType:e.labels.activeLabelType,activePopupType:e.general.activePopupType,activeLabelId:e.labels.activeLabelId,customCursorStyle:e.general.customCursorStyle,imageDragMode:e.general.imageDragMode,zoom:e.general.zoom})),Tt)(Ct);a(365);var xt=Object(r.b)((e=>({activeImageIndex:e.labels.activeImageIndex,activeContext:e.general.activeContext})),{})((e=>{let{size:t,imageData:a,totalImageCount:i,activeImageIndex:s,activeContext:n}=e;return Object(I.jsxs)("div",{className:v()("EditorBottomNavigationBar",{"with-context":n===K.EDITOR}),children:[Object(I.jsx)(Ye,{image:"ico/left.png",imageAlt:"previous",buttonSize:{width:25,height:25},onClick:()=>Re.getPreviousImage(),isDisabled:0===s,externalClassName:"left"}),t.width>400?Object(I.jsxs)("div",{className:"CurrentImageName",children:[" ",a.fileName," "]}):Object(I.jsxs)("div",{className:"CurrentImageCount",children:[" ",s+1+" / "+i," "]}),Object(I.jsx)(Ye,{image:"ico/right.png",imageAlt:"next",buttonSize:{width:25,height:25},onClick:()=>Re.getNextImage(),isDisabled:s===i-1,externalClassName:"right"})]})}));a(366);const yt={updateImageDragModeStatus:function(e){return{type:L.UPDATE_IMAGE_DRAG_MODE_STATUS,payload:{imageDragMode:e}}},updateCrossHairVisibleStatus:function(e){return{type:L.UPDATE_CROSS_HAIR_VISIBLE_STATUS,payload:{crossHairVisible:e}}}};var St=Object(r.b)((e=>({activeContext:e.general.activeContext,imageDragMode:e.general.imageDragMode,crossHairVisible:e.general.crossHairVisible,activeLabelType:e.labels.activeLabelType})),yt)((e=>{let{activeContext:t,updateImageDragModeStatus:a,updateCrossHairVisibleStatus:i,imageDragMode:s,crossHairVisible:n,activeLabelType:o}=e;const r={width:30,height:30},l=10;return Object(I.jsxs)("div",{className:v()("EditorTopNavigationBar",{"with-context":t===K.EDITOR}),children:[Object(I.jsxs)("div",{className:"ButtonWrapper",children:[Object(I.jsx)(Ye,{image:"ico/zoom-in.png",imageAlt:"zoom-in",buttonSize:r,padding:l,onClick:()=>Le.zoomIn()}),Object(I.jsx)(Ye,{image:"ico/zoom-out.png",imageAlt:"zoom-out",buttonSize:r,padding:l,onClick:()=>Le.zoomOut()}),Object(I.jsx)(Ye,{image:"ico/zoom-fit.png",imageAlt:"zoom-fit",buttonSize:r,padding:l,onClick:()=>Le.setDefaultZoom()}),Object(I.jsx)(Ye,{image:"ico/zoom-max.png",imageAlt:"zoom-max",buttonSize:r,padding:l,onClick:()=>Le.setOneForOneZoom()})]}),Object(I.jsxs)("div",{className:"ButtonWrapper",children:[Object(I.jsx)(Ye,{image:"ico/hand.png",imageAlt:"hand",buttonSize:r,padding:l,onClick:()=>{(s||ue.getZoom()!==je.MIN_ZOOM)&&a(!s)},isActive:s}),Object(I.jsx)(Ye,{image:"ico/cross-hair.png",imageAlt:"cross-hair",buttonSize:r,padding:l,onClick:()=>{i(!n)},isActive:n})]}),(o===h.RECT&&W.isAIObjectDetectorModelLoaded()||o===h.POINT&&W.isAIPoseDetectorModelLoaded())&&Object(I.jsxs)("div",{className:"ButtonWrapper",children:[Object(I.jsx)(Ye,{image:"ico/accept-all.png",imageAlt:"accept-all",buttonSize:r,padding:l,onClick:()=>Et.acceptAllSuggestedLabels(re.getActiveImageData())}),Object(I.jsx)(Ye,{image:"ico/reject-all.png",imageAlt:"reject-all",buttonSize:r,padding:l,onClick:()=>Et.rejectAllSuggestedLabels(re.getActiveImageData())})]})]})}));var ft=Object(r.b)((e=>({windowSize:e.general.windowSize,activeImageIndex:e.labels.activeImageIndex,imagesData:e.labels.imagesData,activeContext:e.general.activeContext,projectType:e.general.projectData.type})))((e=>{let{windowSize:t,activeImageIndex:a,imagesData:s,activeContext:n,projectType:o}=e;const[r,c]=Object(i.useState)(!0),[d,h]=Object(i.useState)(!0),u=()=>{if(t){const e=r?g.SIDE_NAVIGATION_BAR_WIDTH_OPEN_PX:g.SIDE_NAVIGATION_BAR_WIDTH_CLOSED_PX,a=d?g.SIDE_NAVIGATION_BAR_WIDTH_OPEN_PX:g.SIDE_NAVIGATION_BAR_WIDTH_CLOSED_PX;return{width:t.width-e-a,height:t.height-g.TOP_NAVIGATION_BAR_HEIGHT_PX-g.EDITOR_BOTTOM_NAVIGATION_BAR_HEIGHT_PX-g.EDITOR_TOP_NAVIGATION_BAR_HEIGHT_PX}}return null},p=()=>{r?r&&n===K.LEFT_NAVBAR&&ke.restoreCtx():ke.switchCtx(K.LEFT_NAVBAR),c(!r)},b=()=>{d?d&&n===K.RIGHT_NAVBAR&&ke.restoreCtx():ke.switchCtx(K.RIGHT_NAVBAR),h(!d)};return Object(I.jsxs)("div",{className:"EditorContainer",children:[Object(I.jsx)(dt,{direction:l.LEFT,isOpen:r,isWithContext:n===K.LEFT_NAVBAR,renderCompanion:()=>Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(gt,{label:"Images",image:"/ico/camera.png",imageAlt:"images",onClick:p,isActive:r})}),renderContent:()=>Object(I.jsx)(He,{})},"left-side-navigation-bar"),Object(I.jsxs)("div",{className:"EditorWrapper",onMouseDown:()=>ke.switchCtx(K.EDITOR),children:[o===xe.OBJECT_DETECTION&&Object(I.jsx)(St,{},"editor-top-navigation-bar"),Object(I.jsx)(Lt,{size:u(),imageData:s[a]},"editor"),Object(I.jsx)(xt,{imageData:s[a],size:u(),totalImageCount:s.length},"editor-bottom-navigation-bar")]},"editor-wrapper"),Object(I.jsx)(dt,{direction:l.RIGHT,isOpen:d,isWithContext:n===K.RIGHT_NAVBAR,renderCompanion:()=>Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(gt,{label:"Labels",image:"/ico/tags.png",imageAlt:"labels",onClick:b,isActive:d})}),renderContent:()=>Object(I.jsx)(ct,{})},"right-side-navigation-bar")]})}));a(367),a(368);var wt=Object(r.b)((e=>({imagesData:e.labels.imagesData,activeLabelType:e.labels.activeLabelType})),{})((e=>{let{imagesData:t,activeLabelType:a}=e;const i=t.reduce(((e,t)=>e+(t.labelPoints.length>0?1:0)),0),s=t.reduce(((e,t)=>e+(t.labelRects.length>0?1:0)),0),n=t.reduce(((e,t)=>e+(t.labelPolygons.length>0?1:0)),0),o=t.reduce(((e,t)=>e+(t.labelLines.length>0?1:0)),0),r=t.reduce(((e,t)=>e+(0!==t.labelNameIds.length?1:0)),0);return Object(I.jsx)("div",{className:"StateBar",children:Object(I.jsx)("div",{style:{width:(()=>{switch(a){case h.POINT:return 100*i/t.length;case h.RECT:return 100*s/t.length;case h.POLYGON:return 100*n/t.length;case h.LINE:return 100*o/t.length;case h.IMAGE_RECOGNITION:return 100*r/t.length;default:return 0}})()+"%"},className:"done"})})}));a(369);const Dt=[{name:"Actions",imageSrc:"ico/actions.png",imageAlt:"actions",disabled:!1,children:[{name:"Import Annotations",description:"Import annotations from file",imageSrc:"ico/import-labels.png",imageAlt:"import-labels",disabled:!1,onClick:()=>Ii.dispatch(q(c.IMPORT_ANNOTATIONS))},{name:"Export Annotations",description:"Export annotations to file",imageSrc:"ico/export-labels.png",imageAlt:"export-labels",disabled:!1,onClick:()=>Ii.dispatch(q(c.EXPORT_ANNOTATIONS))},{name:"Upload Annotations",description:"Upload annotation files",imageSrc:"ico/upload.png",imageAlt:"import-labels",disabled:!1,onClick:()=>Ii.dispatch(q(c.UPLOAD_ANNOTATIONS))},{name:"Download Annotations",description:"Download annotation files",imageSrc:"ico/down.png",imageAlt:"export-labels",disabled:!1,onClick:()=>Ii.dispatch(q(c.DOWNLOAD_ANNOTATIONS))},{name:"Delete Annotations",description:"Download annotation files",imageSrc:"ico/delete.png",imageAlt:"export-labels",disabled:!1,onClick:()=>Ii.dispatch(q(c.DELETE_ANNOTATIONS))}]},{name:"More",imageSrc:"ico/more.png",imageAlt:"more",disabled:!1,children:[{name:"Camera ID",description:"Select Camera ID",imageSrc:"ico/bug.png",imageAlt:"bug",disabled:!1,onClick:()=>Ii.dispatch(q(c.LOAD_CAMERA_ID))}]}],Nt={updatePreventCustomCursorStatus:$};var Rt=Object(r.b)((e=>({})),Nt)((e=>{let{updatePreventCustomCursorStatus:t}=e;const[a,s]=Object(i.useState)(null),[n,o]=Object(i.useState)(null),r=e=>{t(!0)},l=e=>{t(!1)},c=e=>{e.target.classList.contains("DropDownMenuTab")||e.target.classList.contains("DropDownMenuContentOption")||(s(null),document.removeEventListener(le.MOUSE_DOWN,c))},d=(e,a)=>()=>{a||(e&&e(),s(null),t(!1),document.removeEventListener(le.MOUSE_DOWN,c))},g=(e,t)=>{return Object(I.jsxs)("div",{className:(i=t,v()("DropDownMenuTab",{active:i===a})),onClick:e=>((e,t)=>{null===a&&document.addEventListener(le.MOUSE_DOWN,c),a===e?(s(null),o(null)):(s(e),o({x:t.target.offsetLeft,y:35}))})(t,e),onMouseEnter:e=>((e,t)=>{null!==a&&a!==e&&(s(e),o({x:t.target.offsetLeft,y:35}))})(t,e),children:[Object(I.jsx)("img",{draggable:!1,src:e.imageSrc,alt:e.imageAlt}),e.name]},t);var i};return Object(I.jsx)("div",{className:"DropDownMenuWrapper",children:Object(I.jsxs)(I.Fragment,{children:[Dt.map(((e,t)=>g(e,t))),(e=>{if(null!==a){const t={top:35,left:n.x,height:40*e.children.length+10};return Object(I.jsx)("div",{className:"DropDownMenuContent",style:t,onMouseEnter:r,onMouseLeave:l,children:e.children.map(((e,t)=>{return Object(I.jsxs)("div",{className:(a=e.disabled,v()("DropDownMenuContentOption",{active:!a})),onClick:d(e.onClick,e.disabled),children:[Object(I.jsx)("div",{className:"Marker"}),Object(I.jsx)("img",{src:e.imageSrc,alt:e.imageAlt}),e.name]},t);var a}))})}return null})(Dt[a])]})})}));const _t={updateActivePopupType:q,updateProjectData:ee};var Mt=Object(r.b)((e=>({projectData:e.general.projectData})),_t)((e=>{let{updateActivePopupType:t,updateProjectData:a,projectData:i}=e;return Object(I.jsxs)("div",{className:"TopNavigationBar",children:[Object(I.jsx)(wt,{}),Object(I.jsxs)("div",{className:"TopNavigationBarWrapper",children:[Object(I.jsx)("div",{className:"NavigationBarGroupWrapper",children:Object(I.jsx)("div",{className:"Header",onClick:()=>t(c.EXIT_PROJECT),children:"Pixel Sensor"})}),Object(I.jsx)("div",{className:"NavigationBarGroupWrapper",children:Object(I.jsx)(Rt,{})}),Object(I.jsxs)("div",{className:"NavigationBarGroupWrapper middle",children:[Object(I.jsx)("div",{className:"ProjectName",children:"Camera Id:"}),Object(I.jsx)("p",{children:i.name})]})]})]})}));var Bt=Object(r.b)((e=>({activePopupType:e.general.activePopupType})))((e=>{let{activePopupType:t}=e;return Object(I.jsxs)("div",{className:v()("EditorView",{withPopup:!!t}),draggable:!1,children:[Object(I.jsx)(Mt,{}),Object(I.jsx)(ft,{})]})}));a(370),a(371);const Vt=e=>{const{key:t,label:a,onClick:i,style:s,isActive:n,isDisabled:o,externalClassName:r}=e;return Object(I.jsx)("div",{className:v()("TextButton",r,{active:n,disabled:o}),onClick:e=>{e.stopPropagation(),i&&i()},style:s,children:a},t)};a(372);class Ut{static createImageDataFromFileData(e){return{id:me()(),fileName:e,loadStatus:!1,labelRects:[],labelPoints:[],labelLines:[],labelPolygons:[],labelNameIds:[],isVisitedByObjectDetector:!1,isVisitedByPoseDetector:!1}}static cleanAnnotations(e){return{...e,labelRects:[],labelPoints:[],labelLines:[],labelPolygons:[],labelNameIds:[]}}static arrange(e,t){return e.sort(((e,a)=>t.indexOf(e.id)-t.indexOf(a.id)))}static loadMissingImages(e){return new Promise(((t,a)=>{const i=e.filter((e=>!e.loadStatus)),s=i.map((e=>e.fileName));H.loadImages(s).then((e=>{T.storeImages(i.map((e=>e.id)),e),t()})).catch((e=>a(e)))}))}}var Ft=a(53),zt=a.n(Ft);const kt={updateActiveImageIndex:x,addImageData:N,updateProjectData:ee,updateActivePopupType:q,updateConfigFolder:function(e){return{type:L.UPDATE_CONFIG_FOLDER,payload:{configFolder:e}}},updateLabelNames:_,updateErrorMsg:function(e){return{type:L.UPDATE_ERROR_MSG,payload:{error:e}}}};var Gt=Object(r.b)((e=>({projectData:e.general.projectData,configFolder:e.general.configFolder})),kt)((e=>{let{updateActiveImageIndex:t,addImageData:a,updateProjectData:s,updateActivePopupType:n,updateConfigFolder:o,updateLabelNames:r,updateErrorMsg:l,projectData:d}=e;const[g,h]=Object(i.useState)(!1),u=async(e,i)=>{try{let n=await zt.a.get(V,{params:{dir:i}});n.data.files.length>0&&("captures"===i?(r([{id:"609dedef-8391-461e-bf6e-019c4ccd734c",name:"S-1"},{id:"f36d71b3-510d-4ab2-b560-6eebaa319cab",name:"S-2"},{id:"f30239d5-2319-4d4f-ab8f-ee6e89e3581b",name:"S-3"},{id:"7a25b2ed-2301-4d07-9807-ddf5d55b1747",name:"S-4"}]),await a([Ut.createImageDataFromFileData(i+"/270.jpg")])):"tables"===i&&(r([{id:"609dedef-8391-461e-bf6e-019c4ccd734c",name:"T-1"},{id:"f36d71b3-510d-4ab2-b560-6eebaa319cab",name:"T-2"},{id:"f30239d5-2319-4d4f-ab8f-ee6e89e3581b",name:"T-3"},{id:"7a25b2ed-2301-4d07-9807-ddf5d55b1747",name:"T-4"},{id:"f36d71b3-510d-4ab2-b560-6eebaa319ca7",name:"T-5"},{id:"f30239d5-2319-4d4f-ab8f-ee6e89e35818",name:"T-6"},{id:"7a25b2ed-2301-4d07-9807-ddf5d55b1744",name:"T-7"},{id:"f36d71b3-510d-4ab2-b560-6eebaa319ca2",name:"T-8"},{id:"f30239d5-2319-4d4f-ab8f-ee6e89e35814",name:"T-9"},{id:"7a25b2ed-2301-4d07-9807-ddf5d55b1743",name:"T-10"},{id:"f36d71b3-510d-4ab2-b560-6eebaa319ca1",name:"T-11"},{id:"f30239d5-2319-4d4f-ab8f-ee6e89e35811",name:"T-12"}]),await a(n.data.files.map((e=>Ut.createImageDataFromFileData(i+"/"+e))))),t(0),o(i),s({...d,type:e}))}catch(n){console.log(n)}};return Object(I.jsxs)("div",{className:"ImagesDropZone",children:[Object(I.jsx)("div",{className:"DropZoneButtons",children:Object(I.jsx)(Vt,{label:"1. Capture Scene",onClick:()=>{n(c.LOADER),zt.a.get(U).then((e=>{console.log(e.data),h(!0),n(null)})).catch((e=>{console.log(e),l(e.message),n(c.ERROR)}))}})}),Object(I.jsx)("div",{className:"DropZoneButtons",children:Object(I.jsx)(Vt,{label:"2. Define Sections",isDisabled:!g,onClick:()=>{g&&u(xe.OBJECT_DETECTION,"captures")}})}),Object(I.jsx)("div",{className:"DropZoneButtons",children:Object(I.jsx)(Vt,{label:"3. Define Tables",onClick:()=>{u(xe.OBJECT_DETECTION,"tables")}})})]})}));var Ht=()=>{const[e,t]=Object(i.useState)(!1),[a,s]=Object(i.useState)(!1);return Object(I.jsxs)("div",{className:v()("MainView",{InProgress:e,Canceled:!e&&a}),children:[Object(I.jsx)("div",{className:"Slider",id:"lower",children:Object(I.jsx)("div",{className:"TriangleVertical",children:Object(I.jsx)("div",{className:"TriangleVerticalContent"})})}),Object(I.jsx)("div",{className:"Slider",id:"upper",children:Object(I.jsx)("div",{className:"TriangleVertical",children:Object(I.jsx)("div",{className:"TriangleVerticalContent"})})}),Object(I.jsxs)("div",{className:"LeftColumn",children:[Object(I.jsx)("div",{className:"TriangleVertical",children:Object(I.jsx)("div",{className:"TriangleVerticalContent"})}),e&&Object(I.jsx)(Vt,{label:"Go Back",onClick:()=>{t(!1),s(!0)}})]}),Object(I.jsxs)("div",{className:"RightColumn",children:[Object(I.jsx)("div",{}),Object(I.jsx)(Gt,{}),Object(I.jsx)("div",{className:"SocialMediaWrapper"}),!e&&Object(I.jsx)(Vt,{label:"Get Started",onClick:()=>{t(!0)}})]})]})};a(391),a(392),a(393);const Wt=e=>{let{title:t,renderContent:a,acceptLabel:s,onAccept:n,skipAcceptButton:o,disableAcceptButton:r,rejectLabel:l,onReject:c,skipRejectButton:d,disableRejectButton:g}=e;const[h,u]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{h||(ke.switchCtx(K.POPUP),u(!0))}),[h]),Object(I.jsxs)("div",{className:"GenericYesNoPopup",children:[Object(I.jsx)("div",{className:"Header",children:t}),Object(I.jsx)("div",{className:"Content",children:a()}),Object(I.jsxs)("div",{className:"Footer",children:[!o&&Object(I.jsx)(Vt,{label:s||"YES",onClick:n,externalClassName:"accept",isDisabled:r}),!d&&Object(I.jsx)(Vt,{label:l||"NO, THANKS",onClick:c,externalClassName:"reject",isDisabled:g})]})]})};var Yt=a(88);let Zt=function(e){return e.IMAGE="image/jpeg, image/png",e.TEXT="text/plain",e.JSON="application/json",e.EXCEL=".xls, .xlsx",e}({});class Xt extends Error{constructor(e){super(e),this.name="YOLOAnnotationsLoadingError"}}class Jt extends Xt{constructor(){super("For YOLO labels to be loaded correctly, labels.txt file is required"),this.name="NoLabelNamesFileProvidedError"}}class Kt extends Xt{constructor(){super("Label names listed in labels.txt file should be unique"),this.name="LabelNamesNotUniqueError"}}class qt extends Xt{constructor(e){super("Unexpected error occurred during parsing of ".concat(e," annotations file")),this.name="AnnotationsParsingError"}}class Qt{static parseLabelsNamesFromString(e){const t=e.split(/[\r\n]/).filter(Boolean).map((e=>e.replace(/\s/g,"")));if(Object(C.uniq)(t).length!==t.length)throw new Kt;return t.map((e=>Oe.createLabelName(e)))}static loadLabelsList(e,t,a){const i=new FileReader;i.onloadend=function(e){const a=e.target.result,i=Qt.parseLabelsNamesFromString(a);t(i)},i.onerror=()=>a(),i.readAsText(e)}static parseYOLOAnnotationsFromString(e,t,a,i){return e.split(/[\r\n]/).filter(Boolean).map((e=>Qt.parseYOLOAnnotationFromString(e,t,a,i)))}static parseYOLOAnnotationFromString(e,t,a,i){const s=e.split(" ");if(!Qt.validateYOLOAnnotationComponents(s,t.length))throw new qt(i);const n=t[parseInt(s[0])].id,o=parseFloat(s[1]),r=parseFloat(s[2]),l=parseFloat(s[3]),c=parseFloat(s[4]),d={x:(o-l/2)*a.width,y:(r-c/2)*a.height,width:l*a.width,height:c*a.height};return Oe.createLabelRect(n,d)}static validateYOLOAnnotationComponents(e,t){const a=e=>{const t=Number(e);return!isNaN(t)&&0<=t&&t<=1};return[5===e.length,(e=>{const a=parseInt(e);return!isNaN(a)&&0<=a&&a<t})(e[0]),a(e[1]),a(e[2]),a(e[3]),a(e[4])].every(Boolean)}}const $t={updateActivePopupType:q,updateLabels:_};var ea=Object(r.b)((e=>({configFolder:e.general.configFolder})),$t)((e=>{let{configFolder:t,updateActivePopupType:a,updateLabels:s}=e;const[n,o]=Object(i.useState)([]),[r,l]=Object(i.useState)(!1),{acceptedFiles:d,getRootProps:g,getInputProps:h}=Object(Yt.a)({accept:Zt.EXCEL,multiple:!1,onDrop:e=>{1===e.length&&Qt.loadLabelsList(e[0],u,p)}}),u=e=>{o(e),l(!1)},p=()=>{l(!0)};return Object(I.jsx)(Wt,{title:"Load file with labels description",renderContent:()=>Object(I.jsxs)("div",{className:"LoadLabelsPopupContent",children:[Object(I.jsx)("div",{className:"Message",children:"Load a text file with a list of labels you are planning to use. The names of each label should be separated by new line. If you don't have a prepared file, no problem. You can create your own list now."}),Object(I.jsx)("div",{...g({className:"DropZone"}),children:r?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("input",{...h()}),Object(I.jsx)("img",{draggable:!1,alt:"upload",src:"ico/box-opened.png"}),Object(I.jsx)("p",{className:"extraBold",children:"Loading of labels file was unsuccessful"}),Object(I.jsx)("p",{className:"extraBold",children:"Try again"})]}):0===d.length?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("input",{...h()}),Object(I.jsx)("img",{draggable:!1,alt:"upload",src:"ico/box-opened.png"}),Object(I.jsx)("p",{className:"extraBold",children:"Drop labels file"}),Object(I.jsx)("p",{children:"or"}),Object(I.jsx)("p",{className:"extraBold",children:"Click here to select it"})]}):1===n.length?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("img",{draggable:!1,alt:"uploaded",src:"ico/box-closed.png"}),Object(I.jsx)("p",{className:"extraBold",children:"only 1 label found"})]}):Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("img",{draggable:!1,alt:"uploaded",src:"ico/box-closed.png"}),Object(I.jsxs)("p",{className:"extraBold",children:[n.length," labels found"]})]})})]}),acceptLabel:"Start project",onAccept:()=>{n.length>0&&s(n)},disableAcceptButton:0===n.length,rejectLabel:"Create labels list",onReject:()=>{a(c.INSERT_LABEL_NAMES)}})})),ta=(a(394),a(196)),aa=a.n(ta);const ia={updateActivePopupType:q,updateCameras:function(e){return{type:L.UPDATE_CAMERA_IDS,payload:{cameras:e}}}};var sa=Object(r.b)((e=>({})),ia)((e=>{let{updateActivePopupType:t,updateCameras:a}=e;const[s,n]=Object(i.useState)([]),[o,r]=Object(i.useState)(!1),{acceptedFiles:l,getRootProps:d,getInputProps:g}=Object(Yt.a)({accept:Zt.EXCEL,multiple:!1,onDrop:e=>{if(1===e.length){const t=new FileReader;t.onload=function(e){if(e.target){const t=e.target.result,a=aa.a.read(t,{type:"binary"}),i=aa.a.utils.sheet_to_json(a.Sheets[a.SheetNames[0]],{header:["ID","OPERATION","STATUS","MESSAGE","NAME","SENSOR_TYPE","GROUP_IDENTIFIER","IDENTIFIER","MAKE","MODEL"]});i.splice(0,2),console.log(i);const s=[];i.map((e=>{s.push(e.GROUP_IDENTIFIER)})),h(Object(C.uniq)(s))}},t.onerror=()=>u(),t.readAsBinaryString(e[0])}}}),h=e=>{n(e),r(!1)},u=()=>{r(!0)};return Object(I.jsx)(Wt,{title:"Load file with labels description",renderContent:()=>Object(I.jsxs)("div",{className:"LoadCameraIdsPopupContent",children:[Object(I.jsx)("div",{className:"Message",children:"Load a xls/xlsx file with a list of camera identifiers you are planning to use."}),Object(I.jsx)("div",{...d({className:"DropZone"}),children:o?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("input",{...g()}),Object(I.jsx)("img",{draggable:!1,alt:"upload",src:"ico/box-opened.png"}),Object(I.jsx)("p",{className:"extraBold",children:"Loading of xls/xlsx file was unsuccessful"}),Object(I.jsx)("p",{className:"extraBold",children:"Try again"})]}):0===l.length?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("input",{...g()}),Object(I.jsx)("img",{draggable:!1,alt:"upload",src:"ico/box-opened.png"}),Object(I.jsx)("p",{className:"extraBold",children:"Drop xls/xlsx file"}),Object(I.jsx)("p",{children:"or"}),Object(I.jsx)("p",{className:"extraBold",children:"Click here to select it"})]}):1===s.length?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("img",{draggable:!1,alt:"uploaded",src:"ico/box-closed.png"}),Object(I.jsx)("p",{className:"extraBold",children:"only 1 camera id found"})]}):Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("img",{draggable:!1,alt:"uploaded",src:"ico/box-closed.png"}),Object(I.jsxs)("p",{className:"extraBold",children:[s.length," camera ids found"]})]})})]}),acceptLabel:"Select Camera Id",onAccept:()=>{s.length>0&&(a(s),t(c.SELECT_CAMERA_ID))},disableAcceptButton:0===s.length,rejectLabel:"Cancel",onReject:()=>{Fe.close()}})})),na=(a(398),a(276));const oa={updateProjectData:ee};var ra=Object(r.b)((e=>({cameras:e.labels.cameras,projectData:e.general.projectData})),oa)((e=>{let{cameras:t,updateProjectData:a,projectData:i}=e;return Object(I.jsx)(Wt,{title:"Load file with labels description",renderContent:()=>Object(I.jsx)("div",{className:"SelectCameraIdPopupContent",children:Object(I.jsx)(na.a,{className:"Selector",options:t.map((e=>({label:e,value:e}))),onChange:e=>a({...i,name:e.value})})}),acceptLabel:"Submit",onAccept:()=>{console.log(t),Fe.close()},disableAcceptButton:0===t.length,rejectLabel:"Cancel",onReject:()=>{console.log("rejected"),Fe.close()}})}));a(410),a(411);var la=e=>{const{key:t,label:a,isPassword:i,onChange:s,onFocus:n,inputStyle:o,labelStyle:r,barStyle:l,value:c,onKeyUp:d}=e;return Object(I.jsxs)("div",{className:"TextInput",children:[Object(I.jsx)("input",{value:c||void 0,type:i?"password":"text",id:t,style:o,onChange:s||void 0,onFocus:n||void 0,autoFocus:!0,onKeyUp:d}),!!a&&Object(I.jsx)("label",{htmlFor:t,style:r,children:a}),Object(I.jsx)("div",{className:"Bar",style:l})]})};const ca={updateActivePopupType:q,updateLabelNames:_};var da=Object(r.b)((e=>({projectType:e.general.projectData.type})),ca)((e=>{let{projectType:t,updateActivePopupType:a,updateLabelNames:s,isUpdate:n}=e;const o=Oe.convertLabelNamesListToMap(re.getLabelNames()),[r,l]=Object(i.useState)(o),d=()=>{const e={...r,[me()()]:""};l(e)},g=Object.keys(r).map((e=>Object(I.jsxs)("div",{className:"LabelEntry",children:[Object(I.jsx)(la,{value:r[e],isPassword:!1,onChange:t=>h(e,t.target.value),label:"Insert label",onKeyUp:e=>(e=>{"Enter"===e.key&&d()})(e)},e),Object(I.jsx)(Ye,{image:"ico/trash.png",imageAlt:"remove_label",buttonSize:{width:30,height:30},onClick:()=>(e=>{const t={...r};delete t[e],l(t)})(e)})]},e))),h=(e,t)=>{const a={...r,[e]:t};l(a)},u=()=>Object.values(r).filter((e=>!!e));return Object(I.jsx)(Wt,{title:n?"Edit labels":"Create labels",renderContent:()=>Object(I.jsxs)("div",{className:"InsertLabelNamesPopup",children:[Object(I.jsx)("div",{className:"LeftContainer",children:Object(I.jsx)(Ye,{image:"ico/plus.png",imageAlt:"plus",buttonSize:{width:40,height:40},padding:25,onClick:d})}),Object(I.jsxs)("div",{className:"RightContainer",children:[Object(I.jsx)("div",{className:"Message",children:n?"You can now edit the label names you use to describe the objects in the photos. Use the + button to add a new empty text field.":"Before you start, you can create a list of labels you plan to assign to objects in your project. You can also choose to skip that part for now and define label names as you go."}),Object(I.jsx)("div",{className:"LabelsContainer",children:0!==Object.keys(r).length?Object(I.jsx)(p.a,{children:Object(I.jsx)("div",{className:"InsertLabelNamesPopupContent",children:g})}):Object(I.jsxs)("div",{className:"EmptyList",onClick:d,children:[Object(I.jsx)("img",{draggable:!1,alt:"upload",src:"ico/type-writer.png"}),Object(I.jsx)("p",{className:"extraBold",children:"Your label list is empty"})]})})]})]}),acceptLabel:n?"Accept":"Start project",onAccept:n?()=>{const e=u(),t=Oe.convertMapToLabelNamesList(r),i=Oe.labelNamesIdsDiff(re.getLabelNames(),t);Ve.removeLabelNames(i),e.length>0&&(console.log(r),console.log(Oe.convertMapToLabelNamesList(r)),s(Oe.convertMapToLabelNamesList(r)),a(null))}:()=>{u().length>0&&s(Oe.convertMapToLabelNamesList(r)),a(null)},rejectLabel:n?"Cancel":"Load labels from file",onReject:n?()=>{a(null)}:()=>{a(c.LOAD_LABEL_NAMES)}})}));a(412);const ga={updateActiveLabelNameId:y,updateLabelNames:_,updateProjectData:ee,updateActiveImageIndex:x,updateImageData:R,updateFirstLabelCreatedFlag:M};var ha=Object(r.b)((e=>({projectData:e.general.projectData})),ga)((e=>{const{updateActiveLabelNameId:t,updateLabelNames:a,updateActiveImageIndex:i,updateImageData:s,updateFirstLabelCreatedFlag:n,updateProjectData:o,projectData:r}=e;return Object(I.jsx)(Wt,{title:"Exit project",renderContent:()=>Object(I.jsx)("div",{className:"ExitProjectPopupContent",children:Object(I.jsx)("div",{className:"Message",children:"Are you sure you want to leave the editor? You will permanently lose all your progress."})}),acceptLabel:"Exit",onAccept:()=>{t(null),a([]),o({type:null,name:"my-project-name"}),i(null),s([]),n(!1),Fe.close()},rejectLabel:"Back",onReject:()=>{Fe.close()}})}));a(413);var ua=Object(r.b)((e=>({error:e.general.error})),{})((e=>{const{error:t}=e;return Object(I.jsx)(Wt,{title:"Error",renderContent:()=>Object(I.jsx)("div",{className:"ErrorPopupContent",children:Object(I.jsx)("div",{className:"Message",children:t})}),acceptLabel:"Exit",onAccept:()=>{Fe.close()},rejectLabel:"Back",skipRejectButton:!0})}));a(414);const pa={addImageData:N};var ba=Object(r.b)((e=>({})),pa)((e=>{let{addImageData:t}=e;const{acceptedFiles:a,getRootProps:i,getInputProps:s}=Object(Yt.a)({accept:Zt.IMAGE});return Object(I.jsx)(Wt,{title:"Load more images",renderContent:()=>Object(I.jsx)("div",{className:"LoadMoreImagesPopupContent",children:Object(I.jsx)("div",{...i({className:"DropZone"}),children:0===a.length?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("input",{...s()}),Object(I.jsx)("img",{draggable:!1,alt:"upload",src:"ico/box-opened.png"}),Object(I.jsx)("p",{className:"extraBold",children:"Add new images"}),Object(I.jsx)("p",{children:"or"}),Object(I.jsx)("p",{className:"extraBold",children:"Click here to select them"})]}):1===a.length?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("img",{draggable:!1,alt:"uploaded",src:"ico/box-closed.png"}),Object(I.jsx)("p",{className:"extraBold",children:"1 new image loaded"})]}):Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("img",{draggable:!1,alt:"uploaded",src:"ico/box-closed.png"},1),Object(I.jsxs)("p",{className:"extraBold",children:[a.length," new images loaded"]},2)]})})}),acceptLabel:"Load",disableAcceptButton:a.length<1,onAccept:()=>{a.length>0&&(t(a.map((e=>Ut.createImageDataFromFileData(e)))),Fe.close())},rejectLabel:"Cancel",onReject:()=>{Fe.close()}})}));a(415);let ma=function(e){return e.OBJECT_DETECTION="OBJECT_DETECTION",e.POSE_DETECTION="POSE_DETECTION",e}({});const Oa=[{model:ma.OBJECT_DETECTION,name:"COCO SSD - object detection using rectangles",flag:!1},{model:ma.POSE_DETECTION,name:"POSE-NET - pose estimation using points",flag:!1}],Ia=()=>{const[e,t]=Object(i.useState)(!1),[a,s]=Object(i.useState)(Oa),n=()=>{const e=Object(C.findLast)(a,{flag:!0});return e?e.model:null},o=()=>a.map((e=>Object(I.jsxs)("div",{className:"OptionsItem",onClick:()=>(e=>{const t=a.map((t=>t.model===e?{...t,flag:!t.flag}:{...t,flag:!1}));s(t)})(e.model),children:[e.flag?Object(I.jsx)("img",{draggable:!1,src:"ico/checkbox-checked.png",alt:"checked"}):Object(I.jsx)("img",{draggable:!1,src:"ico/checkbox-unchecked.png",alt:"unchecked"}),e.name]},e.model)));return Object(I.jsx)(Wt,{title:"Say hello to AI",renderContent:()=>Object(I.jsxs)("div",{className:"LoadModelPopupContent",children:[Object(I.jsx)("div",{className:"Message",children:"To speed up your work, you can use our AI, which will try to mark objects on your images. Don't worry, your photos are still safe. To take care of your privacy, we decided not to send your images to the server, but instead send our AI to you. When accepting, make sure that you have a fast and stable connection - it may take a few minutes to load the model."}),Object(I.jsx)("div",{className:"Companion",children:e?Object(I.jsx)(j.ClipLoader,{size:40,color:Y.getLeadingColor(),loading:!0}):Object(I.jsx)("div",{className:"Options",children:o()})})]}),acceptLabel:"Use model!",onAccept:()=>{switch(t(!0),n()){case ma.POSE_DETECTION:vt.loadModel((()=>{Fe.close()}));break;case ma.OBJECT_DETECTION:It.loadModel((()=>{Fe.close()}))}},disableAcceptButton:e||!n(),rejectLabel:"I'm going on my own",onReject:()=>{Fe.close()},disableRejectButton:e})};a(416);const Aa={updateLabelNames:_,updateSuggestedLabelList:Ot,updateRejectedSuggestedLabelList:function(e){return{type:L.UPDATE_REJECTED_SUGGESTED_LABEL_LIST,payload:{labelList:e}}}};var Pa=Object(r.b)((e=>({})),Aa)((e=>{let{updateLabelNames:t,updateSuggestedLabelList:a,updateRejectedSuggestedLabelList:s}=e;const[n,o]=Object(i.useState)(!1),[r,l]=Object(i.useState)(W.getSuggestedLabelList().map((e=>({name:e,flag:!1}))));const c=()=>r.reduce(((e,t)=>(t.flag&&e.push(t.name),e)),[]),d=()=>r.reduce(((e,t)=>(t.flag||e.push(t.name),e)),[]),g=()=>r.map((e=>e.name)),h=()=>r.map(((e,t)=>Object(I.jsxs)("div",{className:"OptionsItem",onClick:()=>(e=>{const t=r.map(((t,a)=>e===a?{...t,flag:!t.flag}:t));l(t);const a=t.reduce(((e,t)=>e&&t.flag),!0);o(a)})(t),children:[e.flag?Object(I.jsx)("img",{draggable:!1,src:"ico/checkbox-checked.png",alt:"checked"}):Object(I.jsx)("img",{draggable:!1,src:"ico/checkbox-unchecked.png",alt:"unchecked"}),e.name]},t)));return Object(I.jsx)(Wt,{title:"New classes found",renderContent:()=>Object(I.jsxs)("div",{className:"SuggestLabelNamesPopupContent",children:[Object(I.jsx)("div",{className:"Message",children:"We found objects of classes that are not yet included in the list of labels. Select the names you would like to add. This will help to speed up the labeling process."}),Object(I.jsx)("div",{className:"AllToggle",children:Object(I.jsxs)("div",{className:"OptionsItem",onClick:()=>n?(o(!1),void l(r.map((e=>({...e,flag:!1}))))):(o(!0),void l(r.map((e=>({...e,flag:!0}))))),children:[n?Object(I.jsx)("img",{draggable:!1,src:"ico/checkbox-checked.png",alt:"checked"}):Object(I.jsx)("img",{draggable:!1,src:"ico/checkbox-unchecked.png",alt:"unchecked"}),n?"Deselect all":"Select all"]})}),Object(I.jsx)("div",{className:"LabelNamesContainer",children:Object(I.jsx)(p.a,{autoHeight:!0,children:Object(I.jsx)("div",{className:"LabelNamesContent",children:h()})})})]}),acceptLabel:"Accept",onAccept:()=>{t(c().reduce(((e,t)=>(e.push({name:t,id:me()()}),e)),re.getLabelNames())),s(W.getRejectedSuggestedLabelList().concat(d())),a([]),Fe.close()},rejectLabel:"Reject",onReject:()=>{s(W.getRejectedSuggestedLabelList().concat(g())),a([]),Fe.close()}})}));a(417),a(418);var va=Object(r.b)((e=>({projectType:e.general.projectData.type})),{})((e=>{let{title:t,activeLabelType:a,projectType:s,onLabelTypeChange:n,acceptLabel:o,onAccept:r,skipAcceptButton:l,disableAcceptButton:c,rejectLabel:d,onReject:g,renderInternalContent:h}=e;const[u,p]=Object(i.useState)(a);return Object(I.jsx)(Wt,{title:t,renderContent:()=>Object(I.jsxs)("div",{className:"GenericLabelTypePopupContent",children:[Object(I.jsx)("div",{className:"LeftContainer",children:We.filter((e=>e.labelType===u)).map((e=>Object(I.jsx)(Ye,{image:e.imageSrc,imageAlt:e.imageAlt,buttonSize:{width:40,height:40},padding:20,onClick:()=>{p(e.labelType),n(e.labelType)},isActive:u===e.labelType})))}),Object(I.jsx)("div",{className:"RightContainer",children:h(u)})]}),acceptLabel:o,onAccept:()=>r(u),skipAcceptButton:l,disableAcceptButton:c,rejectLabel:d,onReject:()=>g(u)})}));let ja=function(e){return e.YOLO="YOLO",e.COCO="COCO",e.CSV="CSV",e.JSON="JSON",e.VOC="VOC",e.VGG="VGG",e}({});const Ea={RECT:[{type:ja.YOLO,label:"load/use existing annotation files from server."}],POINT:[],LINE:[],POLYGON:[{type:ja.COCO,label:"Single file in COCO JSON format."}],"IMAGE RECOGNITION":[]};a(419);const Ca=()=>Object(I.jsxs)("div",{className:"FeatureInProgress",children:[Object(I.jsx)("img",{draggable:!1,alt:"take_off",src:"ico/take-off.png"}),Object(I.jsxs)("p",{className:"extraBold",children:["new feature ",Object(I.jsx)("br",{})," coming soon..."]})]});class Ta extends Error{constructor(){super("Given predicate results in more than one value being matched."),this.name="ArrayUtilAmbiguousMatchError"}}class La{static partition(e,t){return e.reduce(((e,a)=>(t(a)?e.pass.push(a):e.fail.push(a),e)),{pass:[],fail:[]})}static match(e,t,a){return e.reduce(((e,i)=>{const s=t.filter((e=>a(i,e)));if(1===s.length)e.push([i,s[0]]);else if(s.length>1)throw new Ta;return e}),[])}static unzip(e){return e.reduce(((e,t)=>(e[0].push(t[0]),e[1].push(t[1]),e)),[[],[]])}}class xa extends Error{constructor(e){super(e),this.name="COCOAnnotationsLoadingError"}}class ya extends xa{constructor(e){super(e),this.name="COCOFormatValidationError"}}class Sa extends xa{constructor(){super("Unexpected error occurred during reading annotations from file"),this.name="COCOAnnotationReadingError"}}class fa extends xa{constructor(){super("COCO annotation file need to be in JSON format"),this.name="COCOAnnotationDeserializationError"}}class wa extends xa{constructor(){super("COCO annotation requires single file but multiple were given"),this.name="COCOAnnotationFileCountError"}}class Da{constructor(e){this.labelType=void 0,this.labelType=e}import(e,t,a){throw new Error("Method not implemented.")}}class Na{static bbox2rect(e){return{x:e[0],y:e[1],width:e[2],height:e[3]}}static segmentation2vertices(e){return e.map((e=>Object(C.chunk)(e,2).map((e=>({x:e[0],y:e[1]})))))}}class Ra extends Da{import(e,t,a){e.length>1&&a(new wa);const i=new FileReader;i.readAsText(e[0]),i.onloadend=e=>{try{const a=re.getImagesData(),i=Ra.deserialize(e.target.result),{imagesData:s,labelNames:n}=this.applyLabels(a,i);t(s,n)}catch(i){a(i)}},i.onerror=()=>a(new Sa)}static deserialize(e){try{return JSON.parse(e)}catch(t){throw new fa}}applyLabels(e,t){Ra.validateCocoFormat(t);const{images:a,categories:i,annotations:s}=t,n=Ra.mapCOCOCategories(i),o=e.map((e=>Ut.cleanAnnotations(e))),r=Ra.partitionImageData(o,a),l=Ra.mapImageData(r.pass,a);for(const d of s)if(l[d.image_id]&&1!==d.iscrowd&&(this.labelType.includes(h.RECT)&&l[d.image_id].labelRects.push(Oe.createLabelRect(n[d.category_id].id,Na.bbox2rect(d.bbox))),this.labelType.includes(h.POLYGON))){const e=Na.segmentation2vertices(d.segmentation);for(const t of e)l[d.image_id].labelPolygons.push(Oe.createLabelPolygon(n[d.category_id].id,t))}const c=Object.values(l).concat(r.fail);return{imagesData:Ut.arrange(c,e.map((e=>e.id))),labelNames:Object.values(n)}}static partitionImageData(e,t){const a=t.map((e=>e.file_name));return La.partition(e,(e=>a.includes(e.fileData.name)))}static mapCOCOCategories(e){return e.reduce(((e,t)=>(e[t.id]={id:me()(),name:t.name},e)),{})}static mapImageData(e,t){const a=t.reduce(((e,t)=>(e[t.file_name]=t.id,e)),{});return e.reduce(((e,t)=>(e[a[t.fileData.name]]=t,e)),{})}static validateCocoFormat(e){const t=Ra.requiredKeys.filter((t=>!e.hasOwnProperty(t)));if(0!==t.length)throw new ya("Uploaded file does not contain all required keys: ".concat(t))}}Ra.requiredKeys=["images","annotations","categories"];class _a extends Da{import(e,t,a){try{const i=re.getImagesData().map((e=>Ut.cleanAnnotations(e))),{labelNameFile:s,annotationFiles:n}=_a.filterFilesData(e,i);console.log("sourceImagesData"),console.log(i),console.log("labelNameFile"),console.log(s),console.log("annotationFiles"),console.log(n);const[o,r]=_a.matchImagesWithAnnotations(i,n),l=H.readFile(s).then((e=>Qt.parseLabelsNamesFromString(e))),c=Ut.loadMissingImages(o),d=H.readFiles(r);Promise.all([l,c,d]).then((e=>{const[a,,s]=e,n=Object(C.zip)(o,s).map((e=>_a.applyAnnotations(e[0],e[1],a)));t(_a.injectImageDataWithAnnotations(i,n),a)})).catch((e=>a(e)))}catch(i){a(i)}}static filterFilesData(e,t){console.log(e);const a=La.partition(e,(e=>e.name===_a.labelsFileName));if(1!==a.pass.length)throw new Jt;const i=t.map((e=>e.fileName)).map((e=>H.extractFileName(e).split("/")[1]));console.log(i);const s=La.partition(e,(e=>i.includes(H.extractFileName(e.name))));return{labelNameFile:a.pass[0],annotationFiles:s.pass}}static matchImagesWithAnnotations(e,t){return La.unzip(La.match(e,t,((e,t)=>H.extractFileName(e.fileName).split("/")[1]===H.extractFileName(t.name))))}static applyAnnotations(e,t,a){const i=T.getById(e.id);return e.labelRects=Qt.parseYOLOAnnotationsFromString(t,a,{width:i.width,height:i.height},e.fileName),e}static injectImageDataWithAnnotations(e,t){return e.map((e=>{const a=Object(C.find)(t,{id:e.id});return a||e}))}}_a.labelsFileName="labels.txt";const Ma={COCO:Ra,CSV:void 0,JSON:void 0,VGG:void 0,VOC:void 0,YOLO:_a},Ba={updateImageData:R,updateLabelNames:_,updateActiveLabelType:w};var Va=Object(r.b)((e=>({activeLabelType:e.labels.activeLabelType,configFolder:e.general.configFolder})),Ba)((e=>{let{activeLabelType:t,configFolder:a,updateImageData:s,updateLabelNames:n,updateActiveLabelType:o}=e;const r=e=>{const t=Ea[e];return 1===t.length?t[0].type:null},[l,c]=Object(i.useState)(t),[d,g]=Object(i.useState)(r(t)),[h,u]=Object(i.useState)([]),[p,b]=Object(i.useState)([]),[m,O]=Object(i.useState)(null);Object(i.useEffect)((()=>{zt.a.get(F,{params:{dir:a}}).then((async e=>{console.log(e.data.files);const t=[];for(const s of e.data.files)try{let e=await zt.a.get(B+a+"/"+s),i=new File([e.data],s);t.push(i),console.log(t)}catch(i){console.log(i)}return t})).then((e=>{console.log(e);new Ma[d]([l]).import(e,v,j)})).catch((e=>{console.log(e)}))}),[]);const{getRootProps:A,getInputProps:P}=Object(Yt.a)({accept:[Zt.JSON,Zt.TEXT],multiple:!0,onDrop:e=>{console.log(e),console.log(l);new Ma[d]([l]).import(e,v,j)}}),v=(e,t)=>{u(t),b(e),O(null)},j=e=>{u([]),b([]),O(e)},E=e=>e.map((e=>Object(I.jsxs)("div",{className:"OptionsItem",onClick:()=>{return t=e.type,void g(t);var t},children:[e.type===d?Object(I.jsx)("img",{draggable:!1,src:"ico/checkbox-checked.png",alt:"checked"}):Object(I.jsx)("img",{draggable:!1,src:"ico/checkbox-unchecked.png",alt:"unchecked"}),e.label]},e.type)));return Object(I.jsx)(va,{activeLabelType:l,title:"Import ".concat(l.toLowerCase()," annotations"),onLabelTypeChange:e=>{c(e),g(r(e)),u([]),b([]),O(null)},acceptLabel:"Import",onAccept:e=>{0!==h.length&&0!==p.length&&(s(p),n(h),o(e),Fe.close())},skipAcceptButton:0===Ea[l].length,disableAcceptButton:0===p.length||0===h.length||!!m,rejectLabel:"Cancel",onReject:e=>{Fe.close()},renderInternalContent:e=>{if(console.log("renderInternalContent"),!d&&0!==Ea[e].length)return[Object(I.jsx)("div",{className:"Message",children:"Select import options."}),Object(I.jsx)("div",{className:"Options",children:E(Ea[e])})];const t=Ea[e];return console.log(t),0===t.length?Object(I.jsx)(Ca,{}):Object(I.jsx)("div",{...A({className:"DropZone"}),children:(console.log("getDropZoneContent"),m?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("input",{...P()}),Object(I.jsx)("img",{draggable:!1,alt:"upload",src:"ico/box-opened.png"}),Object(I.jsx)("p",{className:"extraBold",children:"Annotation import was unsuccessful"}),m.message,Object(I.jsx)("p",{className:"extraBold",children:"Try again"})]}):0!==p.length&&0!==h.length?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("img",{draggable:!1,alt:"uploaded",src:"ico/box-closed.png"}),Object(I.jsx)("p",{className:"extraBold",children:"Annotation ready for import"}),"After import you will lose all your current annotations"]}):Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("input",{...P()}),Object(I.jsx)("img",{draggable:!1,alt:"upload",src:"ico/box-opened.png"}),Object(I.jsx)("p",{className:"extraBold",children:"Drop ".concat(d," annotations")}),Object(I.jsx)("p",{children:"or"}),Object(I.jsx)("p",{className:"extraBold",children:"Click here to select them"})]}))})}})})),Ua=(a(420),a(195)),Fa=a.n(Ua),za=a(187);class ka{static sanitize(e){return e.replace("<","&lt;").replace(">","&gt;").replace("&","&amp;").replace("'","&#39;").replace("/","&#x2F;")}}var Ga=a(274),Ha=a.n(Ga);class Wa{static getExportFileName(){const e=ue.getProjectName(),t=Ha()().format("YYYY-MM-DD-hh-mm-ss");return"labels_".concat(e,"_").concat(t)}static saveAs(e,t){const a=new Blob([e],{type:"text/plain;charset=utf-8"});try{Object(za.saveAs)(a,t)}catch(i){throw new Error(i)}}}class Ya{static async export(e,t){switch(e){case ja.YOLO:await Ya.exportAsYOLO(t),await Ya.exportAsCSV();break;case ja.VOC:Ya.exportAsVOC();break;case ja.CSV:Ya.exportAsCSV();break;default:return}}static exportAsYOLO(e){console.log(e),"captures"===e&&zt.a.get(G,{params:{dir:"tables"}}).then((e=>{console.log(e)})).catch((e=>{console.log(e)})),re.getImagesData().forEach((e=>{const t=Ya.wrapRectLabelsIntoYOLO(e);if(t){let i,s;console.log(e.fileName),[s,i]=e.fileName.split("/"),i=i.replace(/\.[^/.]+$/,".txt"),console.log(i,s);try{const e=new FormData;e.append("annotations",new Blob([t]),i),zt.a.post(z,e,{headers:{Accept:"application/json","Content-Type":"multipart/form-data"},params:{dir:s,fileName:i}})}catch(a){if(a instanceof Error)throw new Error(a.message)}}}))}static wrapRectLabelsIntoYOLO(e){if(0===e.labelRects.length||!e.loadStatus)return null;const t=re.getLabelNames(),a=T.getById(e.id);return e.labelRects.map((e=>[Object(C.findIndex)(t,{id:e.labelId}).toString(),((e.rect.x+e.rect.width/2)/a.width).toFixed(6).toString(),((e.rect.y+e.rect.height/2)/a.height).toFixed(6).toString(),(e.rect.width/a.width).toFixed(6).toString(),(e.rect.height/a.height).toFixed(6).toString()].join(" "))).join("\n")}static exportAsVOC(){let e=new Fa.a;re.getImagesData().forEach((t=>{const a=Ya.wrapImageIntoVOC(t);if(a){const s=t.fileName.replace(/\.[^/.]+$/,".xml");try{e.file(s,a)}catch(i){if(i instanceof Error)throw new Error(i.message)}}}));try{e.generateAsync({type:"blob"}).then((function(e){Object(za.saveAs)(e,"".concat(Wa.getExportFileName(),".zip"))}))}catch(t){if(t instanceof Error)throw new Error(t.message)}}static wrapRectLabelsIntoVOC(e){if(0===e.labelRects.length||!e.loadStatus)return null;const t=re.getLabelNames();return e.labelRects.map((e=>{const a=Object(C.findLast)(t,{id:e.labelId});return(a?["\t<object>","\t\t<name>".concat(a.name,"</name>"),"\t\t<pose>Unspecified</pose>","\t\t<truncated>Unspecified</truncated>","\t\t<difficult>Unspecified</difficult>","\t\t<bndbox>","\t\t\t<xmin>".concat(Math.round(e.rect.x),"</xmin>"),"\t\t\t<ymin>".concat(Math.round(e.rect.y),"</ymin>"),"\t\t\t<xmax>".concat(Math.round(e.rect.x+e.rect.width),"</xmax>"),"\t\t\t<ymax>".concat(Math.round(e.rect.y+e.rect.height),"</ymax>"),"\t\t</bndbox>","\t</object>"]:[]).join("\n")})).join("\n")}static wrapImageIntoVOC(e){const t=Ya.wrapRectLabelsIntoVOC(e),a=ka.sanitize(ue.getProjectName());if(t){const i=T.getById(e.id);return["<annotation>","\t<folder>".concat(a,"</folder>"),"\t<filename>".concat(e.fileName,"</filename>"),"\t<path>/".concat(a,"/").concat(e.fileName,"</path>"),"\t<source>","\t\t<database>Unspecified</database>","\t</source>","\t<size>","\t\t<width>".concat(i.width,"</width>"),"\t\t<height>".concat(i.height,"</height>"),"\t\t<depth>3</depth>","\t</size>",t,"</annotation>"].join("\n")}return null}static async exportAsCSV(){const e=re.getImagesData();for(const a of e){const e=Ya.wrapRectLabelsIntoCSV(a);if(e){let i,s;if([s,i]=a.fileName.split("/"),"captures"===s){i=i.replace(/\.[^/.]+$/,".csv");try{const t=new FormData;t.append("annotations",new Blob([e]),i),await zt.a.post(z,t,{headers:{Accept:"application/json","Content-Type":"multipart/form-data"},params:{dir:s,fileName:i}})}catch(t){if(t instanceof Error)throw new Error(t.message)}}}}}static wrapRectLabelsIntoCSV(e){if(0===e.labelRects.length||!e.loadStatus)return null;const t=T.getById(e.id),a=re.getLabelNames();return e.labelRects.map((i=>{const s=Object(C.findLast)(a,{id:i.labelId});return(s?[s.name,Math.round(i.rect.x).toString(),Math.round(i.rect.y).toString(),Math.round(i.rect.width).toString(),Math.round(i.rect.height).toString(),e.fileName,t.width.toString(),t.height.toString()]:[]).join(",")})).join("\n")}}class Za{static export(e){e===ja.CSV&&Za.exportAsCSV()}static exportAsCSV(){const e=re.getImagesData().map((e=>Za.wrapRectLabelsIntoCSV(e))).filter((e=>!!e)).join("\n"),t="".concat(Wa.getExportFileName(),".csv");Wa.saveAs(e,t)}static wrapRectLabelsIntoCSV(e){if(0===e.labelPoints.length||!e.loadStatus)return null;const t=T.getById(e.id),a=re.getLabelNames();return e.labelPoints.map((i=>{const s=Object(C.findLast)(a,{id:i.labelId});return(s?[s.name,Math.round(i.point.x).toString(),Math.round(i.point.y).toString(),e.fileData.name,t.width.toString(),t.height.toString()]:[]).join(",")})).join("\n")}}class Xa{static export(){const e=re.getImagesData(),t=re.getLabelNames(),a=JSON.stringify(Xa.mapImagesDataToVGGObject(e,t)),i="".concat(Wa.getExportFileName(),".json");Wa.saveAs(a,i)}static mapImagesDataToVGGObject(e,t){return e.reduce(((e,a)=>{const i=Xa.mapImageDataToVGGFileData(a,t);return i&&(e[a.fileData.name]=i),e}),{})}static mapImageDataToVGGFileData(e,t){const a=Xa.mapImageDataToVGG(e,t);return a?{fileref:"",size:e.fileData.size,filename:e.fileData.name,base64_img_data:"",file_attributes:{},regions:a}:null}static mapImageDataToVGG(e,t){if(!e.loadStatus||!e.labelPolygons||!e.labelPolygons.length||!t||!t.length)return null;const a=Xa.getValidPolygonLabels(e);return a.length?a.reduce(((e,a,i)=>{const s=Object(C.findLast)(t,{id:a.labelId});return s&&(e[i.toString()]={shape_attributes:Xa.mapPolygonToVGG(a.vertices),region_attributes:{label:s.name}}),e}),{}):null}static getValidPolygonLabels(e){return e.labelPolygons.filter((e=>null!==e.labelId&&!!e.vertices.length))}static mapPolygonToVGG(e){if(!e||!e.length)return null;return{name:"polygon",all_points_x:e.map((e=>e.x)).concat(e[0].x),all_points_y:e.map((e=>e.y)).concat(e[0].y)}}}class Ja{static export(){const e=re.getImagesData(),t=re.getLabelNames(),a=ue.getProjectName(),i=Ja.mapImagesDataToCOCOObject(e,t,a),s=JSON.stringify(i),n="".concat(Wa.getExportFileName(),".json");Wa.saveAs(s,n)}static mapImagesDataToCOCOObject(e,t,a){return{info:Ja.getInfoComponent(a),images:Ja.getImagesComponent(e),annotations:Ja.getAnnotationsComponent(e,t),categories:Ja.getCategoriesComponent(t)}}static getInfoComponent(e){return{description:e}}static getCategoriesComponent(e){return e.map(((e,t)=>({id:t+1,name:e.name})))}static getImagesComponent(e){return e.filter((e=>e.loadStatus)).filter((e=>0!==e.labelPolygons.length)).map(((e,t)=>{const a=T.getById(e.id);return{id:t+1,width:a.width,height:a.height,file_name:e.fileData.name}}))}static getAnnotationsComponent(e,t){const a=Ja.mapLabelsData(t);let i=0;const s=e.filter((e=>e.loadStatus)).filter((e=>0!==e.labelPolygons.length)).map(((e,t)=>e.labelPolygons.map((e=>({id:i++,iscrowd:0,image_id:t+1,category_id:a[e.labelId],segmentation:Ja.getCOCOSegmentation(e.vertices),bbox:Ja.getCOCOBbox(e.vertices),area:Ja.getCOCOArea(e.vertices)})))));return Object(C.flatten)(s)}static mapLabelsData(e){return e.reduce(((e,t,a)=>(e[t.id]=a+1,e)),{})}static getCOCOSegmentation(e){const t=e.map((e=>[e.x,e.y]));return[Object(C.flatten)(t)]}static getCOCOBbox(e){let t=e[0].x,a=e[0].x,i=e[0].y,s=e[0].y;for(const n of e)t>n.x&&(t=n.x),a<n.x&&(a=n.x),i>n.y&&(i=n.y),s<n.y&&(s=n.y);return[t,i,a-t,s-i]}static getCOCOArea(e){let t=0,a=e.length-1;for(let i=0;i<e.length;i++)t+=(e[a].x+e[i].x)*(e[a].y-e[i].y),a=i;return Math.abs(t/2)}}class Ka{static export(e){switch(e){case ja.VGG:Xa.export();break;case ja.COCO:Ja.export();break;default:return}}}class qa{static export(e){e===ja.CSV&&qa.exportAsCSV()}static exportAsCSV(){const e=re.getImagesData().map((e=>qa.wrapLineLabelsIntoCSV(e))).filter((e=>!!e)).join("\n"),t="".concat(Wa.getExportFileName(),".csv");Wa.saveAs(e,t)}static wrapLineLabelsIntoCSV(e){if(0===e.labelLines.length||!e.loadStatus)return null;const t=T.getById(e.id),a=re.getLabelNames();return e.labelLines.map((i=>{const s=Object(C.findLast)(a,{id:i.labelId});return(s?[s.name,Math.round(i.line.start.x).toString(),Math.round(i.line.start.y).toString(),Math.round(i.line.end.x).toString(),Math.round(i.line.end.y).toString(),e.fileData.name,t.width.toString(),t.height.toString()]:[]).join(",")})).join("\n")}}class Qa{static export(e){switch(e){case ja.CSV:Qa.exportAsCSV();break;case ja.JSON:Qa.exportAsJSON();break;default:return}}static exportAsCSV(){const e=re.getImagesData().filter((e=>e.labelNameIds.length>0)).map((e=>Qa.wrapLabelNamesIntoCSV(e))).join("\n"),t="".concat(Wa.getExportFileName(),".csv");Wa.saveAs(e,t)}static exportAsJSON(){const e=re.getImagesData().filter((e=>e.labelNameIds.length>0)).map((e=>({image:e.fileData.name,annotations:Qa.wrapLabelNamesIntoJSON(e)}))),t=JSON.stringify(e),a="".concat(Wa.getExportFileName(),".json");Wa.saveAs(t,a)}static wrapLabelNamesIntoCSV(e){if(0===e.labelNameIds.length||!e.loadStatus)return null;const t=re.getLabelNames(),a=e.labelNameIds.map((e=>Object(C.findLast)(t,{id:e}).name));return(0!==a.length?[e.fileData.name,'"['.concat(a.toString(),']"')]:[]).join(",")}static wrapLabelNamesIntoJSON(e){if(0===e.labelNameIds.length||!e.loadStatus)return[];const t=re.getLabelNames();return e.labelNameIds.map((e=>Object(C.findLast)(t,{id:e}).name))}}const $a={RECT:[{type:ja.YOLO,label:"A .txt file in Pixel Sensor format will be saved."},{type:ja.VOC,label:"A .zip package containing files in VOC XML format."},{type:ja.CSV,label:"Single CSV file."}],POINT:[{type:ja.CSV,label:"Single CSV file."}],LINE:[{type:ja.CSV,label:"Single CSV file."}],POLYGON:[{type:ja.VGG,label:"Single file in VGG JSON format."},{type:ja.COCO,label:"Single file in COCO JSON format."}],"IMAGE RECOGNITION":[{type:ja.CSV,label:"Single CSV file."},{type:ja.JSON,label:"Single JSON file."}]};var ei=Object(r.b)((e=>({activeLabelType:e.labels.activeLabelType,configFolder:e.general.configFolder})),{})((e=>{let{activeLabelType:t,configFolder:a}=e;const[s,n]=Object(i.useState)(t),[o,r]=Object(i.useState)(ja.YOLO),l=e=>Object(I.jsxs)("div",{className:"OptionsItem",onClick:()=>(e=>{r(e)})(e[0].type),children:[e[0].type===o?Object(I.jsx)("img",{draggable:!1,src:"ico/checkbox-checked.png",alt:"checked"}):Object(I.jsx)("img",{draggable:!1,src:"ico/checkbox-unchecked.png",alt:"unchecked"}),e[0].label]},e[0].type);return Object(I.jsx)(va,{activeLabelType:s,title:"Export ".concat(s.toLowerCase()," annotations"),onLabelTypeChange:e=>{n(e),r(null)},acceptLabel:"Export",onAccept:async e=>{switch(Fe.loading(),e){case h.RECT:await Ya.export(o,a);break;case h.POINT:Za.export(o);break;case h.LINE:qa.export(o);break;case h.POLYGON:Ka.export(o);break;case h.IMAGE_RECOGNITION:Qa.export(o)}Fe.close()},disableAcceptButton:!o,rejectLabel:"Cancel",onReject:e=>{Fe.close()},renderInternalContent:e=>[Object(I.jsx)("div",{className:"Message",children:"Select label type and the file format you would like to use to export labels."}),Object(I.jsx)("div",{className:"Options",children:l($a[e])})]})}));a(421);var ti=Object(r.b)((e=>({configFolder:e.general.configFolder})))((e=>{let{configFolder:t}=e;const[a,s]=Object(i.useState)(!1),{acceptedFiles:n,getRootProps:o,getInputProps:r}=Object(Yt.a)({accept:Zt.TEXT,multiple:!0});return Object(I.jsx)(Wt,{title:"Upload annotation files",renderContent:()=>Object(I.jsxs)("div",{className:"LoadLabelsPopupContent",children:[Object(I.jsx)("div",{className:"Message",children:"Upload annotation files with .csv and .txt extensions only."}),Object(I.jsx)("div",{...o({className:"DropZone"}),children:a?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("input",{...r()}),Object(I.jsx)("img",{draggable:!1,alt:"upload",src:"ico/box-opened.png"}),Object(I.jsx)("p",{className:"extraBold",children:"Loading of labels file was unsuccessful"}),Object(I.jsx)("p",{className:"extraBold",children:"Try again"})]}):0===n.length?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("input",{...r()}),Object(I.jsx)("img",{draggable:!1,alt:"upload",src:"ico/box-opened.png"}),Object(I.jsx)("p",{className:"extraBold",children:"Drop annotation files"}),Object(I.jsx)("p",{children:"or"}),Object(I.jsx)("p",{className:"extraBold",children:"Click here to select it"})]}):1===n.length?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("img",{draggable:!1,alt:"uploaded",src:"ico/box-closed.png"}),Object(I.jsx)("p",{className:"extraBold",children:"only 1 file selected"})]}):Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("img",{draggable:!1,alt:"uploaded",src:"ico/box-closed.png"}),Object(I.jsxs)("p",{className:"extraBold",children:[n.length," files selected"]})]})})]}),acceptLabel:"Upload",onAccept:async()=>{Fe.loading(),await(async e=>{for(let i=0;i<e.length;i++)try{const a=new FormData;a.append("annotations",e[i],e[i].name),await zt.a.post(z,a,{headers:{Accept:"application/json","Content-Type":"multipart/form-data"},params:{dir:t,fileName:e[i].name}})}catch(a){if(a instanceof Error)throw new Error(a.message)}})(n),Fe.close()},skipAcceptButton:0===n.length,disableAcceptButton:0===n.length,rejectLabel:"Cancel",onReject:()=>{Fe.close()}})})),ai=(a(422),a(275));var ii=Object(r.b)((e=>({configFolder:e.general.configFolder})))((e=>{let{configFolder:t}=e;const{setFilesAsZip:a,saveAsZip:s}=Object(ai.useSaveFilesAsZip)();Object(i.useEffect)((()=>{zt.a.get(F,{params:{dir:t}}).then((async e=>{console.log(e.data.files);const a=[];for(const s of e.data.files)try{let e=await zt.a.get(B+t+"/"+s),i=new File([e.data],s);a.push(i),console.log(a)}catch(i){console.log(i)}return a})).then((e=>{console.log(e),a(e)})).catch((e=>{console.log(e)}))}),[]);return Object(I.jsx)(Wt,{title:"Download annotation files",renderContent:()=>(console.log("renderInternalContent"),Object(I.jsx)("div",{className:"DropZone",children:"Download annotation files"})),acceptLabel:"Download",onAccept:async()=>{Fe.loading(),s(t.toString()),Fe.close()},rejectLabel:"Cancel",onReject:()=>{Fe.close()}})}));a(435);var si=Object(r.b)((e=>({configFolder:e.general.configFolder})))((e=>{let{configFolder:t}=e;const[a,s]=Object(i.useState)(!1);Object(i.useEffect)((()=>{a&&(Fe.loading(),zt.a.get(k,{params:{dir:t}}).then((e=>{console.log(e)})).catch((e=>{console.log(e)})),Fe.close())}),[a]);return Object(I.jsx)(Wt,{title:"Delete annotation files",renderContent:()=>(console.log("renderInternalContent"),Object(I.jsx)("div",{className:"DropZone",children:"Are you sure you want to delete all annotation files?"})),acceptLabel:"Delete",onAccept:async()=>{await s(!0)},rejectLabel:"Cancel",onReject:()=>{Fe.close()}})}));var ni=Object(r.b)((e=>({activePopupType:e.general.activePopupType})))((e=>{let{activePopupType:t}=e;return t&&Object(I.jsx)("div",{className:"PopupView",children:(()=>{switch(t){case c.LOAD_CAMERA_ID:return Object(I.jsx)(sa,{});case c.SELECT_CAMERA_ID:return Object(I.jsx)(ra,{});case c.LOAD_LABEL_NAMES:return Object(I.jsx)(ea,{});case c.EXPORT_ANNOTATIONS:return Object(I.jsx)(ei,{});case c.IMPORT_ANNOTATIONS:return Object(I.jsx)(Va,{});case c.UPLOAD_ANNOTATIONS:return Object(I.jsx)(ti,{});case c.DOWNLOAD_ANNOTATIONS:return Object(I.jsx)(ii,{});case c.DELETE_ANNOTATIONS:return Object(I.jsx)(si,{});case c.INSERT_LABEL_NAMES:return Object(I.jsx)(da,{isUpdate:!1});case c.UPDATE_LABEL:return Object(I.jsx)(da,{isUpdate:!0});case c.EXIT_PROJECT:return Object(I.jsx)(ha,{});case c.IMPORT_IMAGES:return Object(I.jsx)(ba,{});case c.LOAD_AI_MODEL:return Object(I.jsx)(Ia,{});case c.SUGGEST_LABEL_NAMES:return Object(I.jsx)(Pa,{});case c.LOADER:return Object(I.jsx)(j.ClipLoader,{size:100,color:"#7a0000",loading:!0});case c.ERROR:return Object(I.jsx)(ua,{});default:return null}})()})}));a(436);const oi=[{displayText:"Open source and free to use under GPLv3 license",imageSrc:"ico/open-source.png",imageAlt:"open-source"},{displayText:"No advanced installation required, just open up your browser",imageSrc:"ico/online.png",imageAlt:"online"},{displayText:"We don't store your images, because we don't send them anywhere",imageSrc:"ico/private.png",imageAlt:"private"},{displayText:"Support multiple label types - rects, lines, points and polygons",imageSrc:"ico/labels.png",imageAlt:"labels"},{displayText:"Support output file formats like YOLO, VOC XML, VGG JSON, CSV",imageSrc:"ico/file.png",imageAlt:"file"},{displayText:"Use AI to make your work more productive",imageSrc:"ico/robot.png",imageAlt:"robot"}],ri=[{displayName:"Github",imageSrc:"/ico/github-logo.png",imageAlt:"GitHub Logo",href:g.GITHUB_URL,tooltipMessage:"Show me some love on GitHub"},{displayName:"Medium",imageSrc:"/ico/medium-logo.png",imageAlt:"Medium Logo",href:g.MEDIUM_URL,tooltipMessage:"Read my AI content on Medium"},{displayName:"Patreon",imageSrc:"/ico/patreon-logo.png",imageAlt:"Patreon Logo",href:g.PATREON_URL,tooltipMessage:"Support MakeSense on Patreon and help it grow"}];var li=Object(r.b)((e=>({size:e.general.windowSize})),{})((e=>{let{size:t}=e;const[a,s]=Object(i.useState)(0),n=e=>e.map((e=>Object(I.jsx)("div",{className:"EditorFeaturesTiles",children:Object(I.jsxs)("div",{className:"EditorFeaturesTilesWrapper",children:[Object(I.jsx)("img",{draggable:!1,alt:e.imageAlt,src:e.imageSrc}),Object(I.jsx)("div",{className:"EditorFeatureLabel",children:e.displayText})]})},e.displayText))),o=Object(I.jsxs)("div",{className:v()("MobileTopNavigationBar",{Hide:a<350,Show:a>=350}),children:[Object(I.jsx)("div",{className:"NavigationBarGroupWrapper",children:Object(I.jsxs)("div",{className:"Header",children:[Object(I.jsx)("img",{draggable:!1,alt:"make-sense",src:"/dbFavicon.png"}),"Make Sense"]})}),Object(I.jsx)("div",{className:"TriangleHorizontal Bottom",children:Object(I.jsx)("div",{className:"TriangleHorizontalContent"})})]}),r=Object(I.jsxs)("div",{className:"FirstStage",children:[Object(I.jsx)("img",{draggable:!1,alt:"main-logo",src:"ico/main-image-color.png"}),Object(I.jsx)("div",{className:"TriangleHorizontal Bottom",children:Object(I.jsx)("div",{className:"TriangleHorizontalContent"})})]}),l=Object(I.jsx)("div",{className:"SecondStage",children:n(oi.slice(0,3))}),c=Object(I.jsxs)("div",{className:"ThirdStage",children:[n(oi.slice(3,6)),Object(I.jsx)("div",{className:"TriangleHorizontal Top",children:Object(I.jsx)("div",{className:"TriangleHorizontalContent"})}),Object(I.jsx)("div",{className:"TriangleHorizontal Bottom",children:Object(I.jsx)("div",{className:"TriangleHorizontalContent"})})]}),d=Object(I.jsxs)("div",{className:"FourthStage",children:[Object(I.jsx)("div",{className:"Message",children:"Due to the small size of the screen we do not support our editor on mobile devices. Check what you missed and visit us from a desktop."}),Object(I.jsx)("div",{className:"SocialMediaWrapper",children:(e=>ri.map(((t,a)=>Object(I.jsx)(Ye,{buttonSize:e,image:t.imageSrc,imageAlt:t.imageAlt,href:t.href},a))))({width:40,height:40})})]});return Object(I.jsxs)("div",{className:"MobileMainView",children:[o,Object(I.jsx)(p.a,{onScrollFrame:e=>{s(e.scrollTop)},children:Object(I.jsxs)("div",{className:"MobileMainViewContent",style:{width:t.width},children:[r,l,c,d]})})]})}));a(437);const ci=()=>Object(I.jsxs)("div",{className:"SizeItUpView",children:[Object(I.jsx)("p",{className:"extraBold",children:"Ops... This window is to tight for me!"}),Object(I.jsx)("img",{draggable:!1,alt:"small_window",src:"ico/small_window.png"}),Object(I.jsxs)("p",{className:"extraBold",children:["Please... make it at least ",g.EDITOR_MIN_WIDTH," x ",g.EDITOR_MIN_HEIGHT," px."]})]});var di=Object(r.b)((e=>({projectType:e.general.projectData.type,windowSize:e.general.windowSize,ObjectDetectorLoaded:e.ai.isObjectDetectorLoaded,PoseDetectionLoaded:e.ai.isPoseDetectorLoaded})))((e=>{let{projectType:t,windowSize:a,ObjectDetectorLoaded:i,PoseDetectionLoaded:s}=e;return Object(I.jsxs)("div",{className:v()("App",{AI:i||s}),draggable:!1,children:[ut.mobileDeviceData.manufacturer&&ut.mobileDeviceData.os?Object(I.jsx)(li,{}):t?a.height<g.EDITOR_MIN_HEIGHT||a.width<g.EDITOR_MIN_WIDTH?Object(I.jsx)(ci,{}):Object(I.jsx)(Bt,{}):Object(I.jsx)(Ht,{}),Object(I.jsx)(ni,{})]})})),gi=a(189);const hi={activeImageIndex:null,activeLabelNameId:null,activeLabelType:null,activeLabelId:null,highlightedLabelId:null,imagesData:[],firstLabelCreatedFlag:!1,labels:[],cameras:[]};const ui={configFolder:null,windowSize:null,activePopupType:null,customCursorStyle:oe.DEFAULT,activeContext:null,preventCustomCursor:!1,imageDragMode:!1,crossHairVisible:!0,projectData:{type:null,name:null},zoom:je.MIN_ZOOM,error:""};const pi={suggestedLabelList:[],rejectedSuggestedLabelList:[],isObjectDetectorLoaded:!1,isPoseDetectorLoaded:!1,isAIDisabled:!1};const bi=Object(gi.a)({general:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ui,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L.UPDATE_WINDOW_SIZE:return{...e,windowSize:t.payload.windowSize};case L.UPDATE_ACTIVE_POPUP_TYPE:return{...e,activePopupType:t.payload.activePopupType};case L.UPDATE_CUSTOM_CURSOR_STYLE:return{...e,customCursorStyle:t.payload.customCursorStyle};case L.UPDATE_CONTEXT:return{...e,activeContext:t.payload.activeContext};case L.UPDATE_PREVENT_CUSTOM_CURSOR_STATUS:return{...e,preventCustomCursor:t.payload.preventCustomCursor};case L.UPDATE_IMAGE_DRAG_MODE_STATUS:return{...e,imageDragMode:t.payload.imageDragMode};case L.UPDATE_CROSS_HAIR_VISIBLE_STATUS:return{...e,crossHairVisible:t.payload.crossHairVisible};case L.UPDATE_PROJECT_DATA:return{...e,projectData:t.payload.projectData};case L.UPDATE_ZOOM:return{...e,zoom:t.payload.zoom};case L.UPDATE_CONFIG_FOLDER:return{...e,configFolder:t.payload.configFolder};case L.UPDATE_ERROR_MSG:return{...e,error:t.payload.error};default:return e}},labels:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hi,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L.UPDATE_ACTIVE_IMAGE_INDEX:return{...e,activeImageIndex:t.payload.activeImageIndex};case L.UPDATE_ACTIVE_LABEL_NAME_ID:return{...e,activeLabelNameId:t.payload.activeLabelNameId};case L.UPDATE_ACTIVE_LABEL_ID:return{...e,activeLabelId:t.payload.activeLabelId};case L.UPDATE_HIGHLIGHTED_LABEL_ID:return{...e,highlightedLabelId:t.payload.highlightedLabelId};case L.UPDATE_ACTIVE_LABEL_TYPE:return{...e,activeLabelType:t.payload.activeLabelType};case L.UPDATE_IMAGE_DATA_BY_ID:return{...e,imagesData:e.imagesData.map((e=>e.id===t.payload.id?t.payload.newImageData:e))};case L.ADD_IMAGES_DATA:return{...e,imagesData:e.imagesData.concat(t.payload.imageData)};case L.UPDATE_IMAGES_DATA:return{...e,imagesData:t.payload.imageData};case L.UPDATE_LABEL_NAMES:return{...e,labels:t.payload.labels};case L.UPDATE_CAMERA_IDS:return{...e,cameras:t.payload.cameras};case L.UPDATE_FIRST_LABEL_CREATED_FLAG:return{...e,firstLabelCreatedFlag:t.payload.firstLabelCreatedFlag};default:return e}},ai:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pi,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L.UPDATE_SUGGESTED_LABEL_LIST:return{...e,suggestedLabelList:t.payload.labelList};case L.UPDATE_REJECTED_SUGGESTED_LABEL_LIST:return{...e,rejectedSuggestedLabelList:t.payload.labelList};case L.UPDATE_OBJECT_DETECTOR_STATUS:return{...e,isObjectDetectorLoaded:t.payload.isObjectDetectorLoaded};case L.UPDATE_POSE_DETECTOR_STATUS:return{...e,isPoseDetectorLoaded:t.payload.isPoseDetectorLoaded};case L.UPDATE_DISABLED_AI_FLAG:return{...e,isAIDisabled:t.payload.isAIDisabled};default:return e}}});class mi{static isDev(){return!1}static isProd(){return!0}}class Oi{static inti(){Oi.handleResize(),Oi.detectDeviceParams(),Oi.handleAccidentalPageExit(),window.addEventListener(le.RESIZE,Oi.handleResize),window.addEventListener(le.MOUSE_WHEEL,Oi.disableGenericScrollZoom,{passive:!1}),window.addEventListener(le.KEY_DOWN,Oi.disableUnwantedKeyBoardBehaviour),window.addEventListener(le.KEY_PRESS,Oi.disableUnwantedKeyBoardBehaviour),ke.init()}}Oi.handleAccidentalPageExit=()=>{window.onbeforeunload=e=>{null!=ue.getProjectType()&&mi.isProd()&&(e.preventDefault(),e.returnValue="")}},Oi.handleResize=()=>{var e;Ii.dispatch((e={width:window.innerWidth,height:window.innerHeight},{type:L.UPDATE_WINDOW_SIZE,payload:{windowSize:e}}))},Oi.disableUnwantedKeyBoardBehaviour=e=>{ut.isMac&&e.metaKey&&e.preventDefault(),["=","+","-"].includes(e.key)&&(e.ctrlKey||ut.isMac&&e.metaKey)&&e.preventDefault()},Oi.disableGenericScrollZoom=e=>{(e.ctrlKey||ut.isMac&&e.metaKey)&&e.preventDefault()},Oi.detectDeviceParams=()=>{const e=window.navigator.userAgent;ut.mobileDeviceData=Be.getMobileDeviceData(e),ut.isMac=Be.isMac(e),ut.isSafari=Be.isSafari(e),ut.isFirefox=Be.isFirefox(e)};const Ii=Object(gi.b)(bi,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());Oi.inti(),o.a.render(Object(I.jsx)(r.a,{store:Ii,children:Object(I.jsx)(di,{})}),document.getElementById("root")||document.createElement("div"))}},[[438,1,2]]]);
//# sourceMappingURL=main.394518e8.chunk.js.map